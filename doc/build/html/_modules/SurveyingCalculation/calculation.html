

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>SurveyingCalculation.calculation &mdash; Surveying Calculation v0.0.1b1 documentation</title>
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.0.1b1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="Surveying Calculation v0.0.1b1 documentation" href="../../index.html" />
    <link rel="up" title="SurveyingCalculation" href="../SurveyingCalculation.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">Surveying Calculation v0.0.1b1 documentation</a> &raquo;</li>
          <li><a href="../index.html" >Module code</a> &raquo;</li>
          <li><a href="../SurveyingCalculation.html" accesskey="U">SurveyingCalculation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for SurveyingCalculation.calculation</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">.. module: calculation</span>
<span class="sd">    :platform: Linux, Windows</span>
<span class="sd">    :synopsis: pure calculation class</span>

<span class="sd">.. moduleauthor::Zoltan Siki &lt;siki@agt.bme.hu&gt;</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">base_classes</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">resultlog</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">PyQt4.QtCore</span> <span class="kn">import</span> <span class="n">QCoreApplication</span>

<span class="k">class</span> <span class="nc">Calculation</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Container class for calculations. Pure static class.</span>
<div class="viewcode-block" id="Calculation"><a class="viewcode-back" href="../../index.html#SurveyingCalculation.calculation.Calculation">[docs]</a><span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">orientation</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">ref_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Orientation calculation for a station</span>
<div class="viewcode-block" id="Calculation.orientation"><a class="viewcode-back" href="../../index.html#SurveyingCalculation.calculation.Calculation.orientation">[docs]</a>
<span class="sd">            :param st: station (Station)</span>
<span class="sd">            :param ref_list: list of [Point, PolarObservation] lists</span>
<span class="sd">            :returns: average orientation angle (Angle) None if no reference direction at all or in case of error</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sz</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">cz</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">sd</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="n">ref_list</span><span class="p">:</span>
                <span class="n">pt</span> <span class="o">=</span> <span class="n">ref</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">obs</span> <span class="o">=</span> <span class="n">ref</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">b</span> <span class="o">=</span> <span class="n">bearing</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="n">pt</span><span class="p">)</span><span class="o">.</span><span class="n">get_angle</span><span class="p">()</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">obs</span><span class="o">.</span><span class="n">hz</span><span class="o">.</span><span class="n">get_angle</span><span class="p">()</span>
                <span class="n">z</span> <span class="o">=</span> <span class="n">b</span> <span class="o">-</span> <span class="n">r</span>
                <span class="k">if</span> <span class="n">z</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">z</span> <span class="o">=</span> <span class="n">z</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span>
                <span class="n">d</span> <span class="o">=</span> <span class="n">distance2d</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="n">pt</span><span class="p">)</span><span class="o">.</span><span class="n">d</span>
                <span class="n">sd</span> <span class="o">=</span> <span class="n">sd</span> <span class="o">+</span> <span class="n">d</span>
                <span class="n">sz</span> <span class="o">=</span> <span class="n">sz</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">*</span> <span class="n">d</span>
                <span class="n">cz</span> <span class="o">=</span> <span class="n">cz</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">*</span> <span class="n">d</span>
                <span class="n">ref</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
                <span class="n">ref</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Angle</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
                <span class="n">ref</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Angle</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
                <span class="n">ref</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Angle</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
 
            <span class="k">if</span> <span class="n">sd</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">None</span>
        
            <span class="n">sz</span> <span class="o">=</span> <span class="n">sz</span> <span class="o">/</span> <span class="n">sd</span>
            <span class="n">cz</span> <span class="o">=</span> <span class="n">cz</span> <span class="o">/</span> <span class="n">sd</span>
            <span class="c"># Calculate average orient angle.</span>
            <span class="n">za</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">sz</span><span class="p">,</span> <span class="n">cz</span><span class="p">)</span>
            <span class="k">while</span> <span class="n">za</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">za</span> <span class="o">=</span> <span class="n">za</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">None</span>
        
        <span class="c"># log results of orientation?</span>
        <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="n">ref_list</span><span class="p">:</span>
            <span class="n">e</span> <span class="o">=</span> <span class="n">ref</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&quot;SEC&quot;</span><span class="p">)</span> <span class="o">-</span> <span class="n">Angle</span><span class="p">(</span><span class="n">za</span><span class="p">)</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&quot;SEC&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">&gt;</span><span class="n">PISEC</span><span class="p">:</span>
                <span class="n">e</span> <span class="o">=</span> <span class="n">e</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">PISEC</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">&lt;-</span><span class="n">PISEC</span><span class="p">:</span>
                <span class="n">e</span> <span class="o">=</span> <span class="n">e</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">PISEC</span>
            <span class="n">E</span> <span class="o">=</span> <span class="n">e</span> <span class="o">/</span> <span class="n">RO</span> <span class="o">*</span> <span class="n">ref</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">+=</span> <span class="s">u&quot;</span><span class="si">%-10s</span><span class="s"> </span><span class="si">%-10s</span><span class="s">    </span><span class="si">%8.4f</span><span class="s">    </span><span class="si">%8.4f</span><span class="s">    </span><span class="si">%8.4f</span><span class="s">   </span><span class="si">%8.3f</span><span class="s"> </span><span class="si">%4d</span><span class="s"> </span><span class="si">%8.3f</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> \
                <span class="p">(</span><span class="n">ref</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">point_id</span><span class="p">,</span> <span class="p">(</span><span class="n">ref</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">pc</span> <span class="k">if</span> <span class="n">ref</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">pc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="s">&quot;-&quot;</span><span class="p">),</span> \
                <span class="n">ref</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&quot;GON&quot;</span><span class="p">),</span> <span class="n">ref</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&quot;GON&quot;</span><span class="p">),</span> \
                <span class="n">ref</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&quot;GON&quot;</span><span class="p">),</span> <span class="n">ref</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">E</span><span class="p">)</span>
        <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">+=</span><span class="s">u&quot;</span><span class="si">%-48s</span><span class="s"> </span><span class="si">%8.4f</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">tr</span><span class="p">(</span><span class="s">&quot;Average orientation angle&quot;</span><span class="p">),</span> <span class="n">Angle</span><span class="p">(</span><span class="n">za</span><span class="p">)</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&quot;GON&quot;</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Angle</span><span class="p">(</span><span class="n">za</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">polarpoint</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">obs</span><span class="p">):</span></div>
        <span class="sd">&quot;&quot;&quot; Calculate coordinates of a point measured by an independent radial measurement</span>
<div class="viewcode-block" id="Calculation.polarpoint"><a class="viewcode-back" href="../../index.html#SurveyingCalculation.calculation.Calculation.polarpoint">[docs]</a>
<span class="sd">            :param st: station (Station)</span>
<span class="sd">            :param obs: observation from station to the unknown point (PolarObservation)</span>
<span class="sd">            :returns: the polar point with new coordinates (Point)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c"># Calculate the bearing angle between the station and new point.</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">o</span><span class="o">.</span><span class="n">hz</span><span class="o">.</span><span class="n">get_angle</span><span class="p">()</span> <span class="o">+</span> <span class="n">obs</span><span class="o">.</span><span class="n">hz</span><span class="o">.</span><span class="n">get_angle</span><span class="p">()</span>
            <span class="c"># Calculate the coordinates of the new point.</span>
            <span class="n">e</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">e</span> <span class="o">+</span> <span class="n">obs</span><span class="o">.</span><span class="n">horiz_dist</span><span class="p">()</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">n</span> <span class="o">+</span> <span class="n">obs</span><span class="o">.</span><span class="n">horiz_dist</span><span class="p">()</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">st</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">st</span><span class="o">.</span><span class="n">o</span><span class="o">.</span><span class="n">th</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">obs</span><span class="o">.</span><span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">z</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">z</span> <span class="o">+</span> <span class="n">st</span><span class="o">.</span><span class="n">o</span><span class="o">.</span><span class="n">th</span> <span class="o">+</span> <span class="n">obs</span><span class="o">.</span><span class="n">d</span><span class="o">.</span><span class="n">d</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">obs</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">get_angle</span><span class="p">())</span>
                <span class="k">if</span> <span class="n">obs</span><span class="o">.</span><span class="n">th</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">z</span> <span class="o">=</span> <span class="n">z</span> <span class="o">-</span> <span class="n">obs</span><span class="o">.</span><span class="n">th</span> 
            <span class="k">else</span><span class="p">:</span>
                <span class="n">z</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">obs</span><span class="o">.</span><span class="n">point_id</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">obs</span><span class="o">.</span><span class="n">pc</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">z</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="c"># no z calculated</span>
                <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">+=</span> <span class="s">u&quot;</span><span class="si">%-10s</span><span class="s"> </span><span class="si">%-10s</span><span class="s"> </span><span class="si">%12.3f</span><span class="s"> </span><span class="si">%12.3f</span><span class="s">          </span><span class="si">%8.4f</span><span class="s"> </span><span class="si">%8.3f</span><span class="s">&quot;</span> <span class="o">%</span> \
                        <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">id</span><span class="p">,(</span><span class="n">p</span><span class="o">.</span><span class="n">pc</span> <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">pc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="s">&quot;-&quot;</span><span class="p">),</span><span class="n">p</span><span class="o">.</span><span class="n">e</span><span class="p">,</span><span class="n">p</span><span class="o">.</span><span class="n">n</span><span class="p">,</span><span class="n">Angle</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&quot;GON&quot;</span><span class="p">),</span><span class="n">obs</span><span class="o">.</span><span class="n">horiz_dist</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">+=</span> <span class="s">u&quot;</span><span class="si">%-10s</span><span class="s"> </span><span class="si">%-10s</span><span class="s"> </span><span class="si">%12.3f</span><span class="s"> </span><span class="si">%12.3f</span><span class="s"> </span><span class="si">%8.3f</span><span class="s"> </span><span class="si">%8.4f</span><span class="s"> </span><span class="si">%8.3f</span><span class="s">&quot;</span> <span class="o">%</span> \
                        <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">id</span><span class="p">,(</span><span class="n">p</span><span class="o">.</span><span class="n">pc</span> <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">pc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="s">&quot;-&quot;</span><span class="p">),</span><span class="n">p</span><span class="o">.</span><span class="n">e</span><span class="p">,</span><span class="n">p</span><span class="o">.</span><span class="n">n</span><span class="p">,</span><span class="n">p</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="n">Angle</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&quot;GON&quot;</span><span class="p">),</span><span class="n">obs</span><span class="o">.</span><span class="n">horiz_dist</span><span class="p">())</span>
            <span class="k">return</span> <span class="n">p</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">None</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">intersection</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">obs1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">obs2</span><span class="p">):</span></div>
        <span class="sd">&quot;&quot;&quot; Calculate intersection</span>
<div class="viewcode-block" id="Calculation.intersection"><a class="viewcode-back" href="../../index.html#SurveyingCalculation.calculation.Calculation.intersection">[docs]</a>
<span class="sd">            :param s1: station 1 (Station)</span>
<span class="sd">            :param obs1: observation from station 1 (PolarObservation)</span>
<span class="sd">            :param s2: station 2 (Station)</span>
<span class="sd">            :param obs2: observation from station 2 (PolarObservation)</span>
<span class="sd">            :returns: intersection point (Point)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="c"># If the two observation are the same.</span>
        <span class="k">if</span> <span class="n">obs1</span><span class="o">.</span><span class="n">point_id</span> <span class="o">!=</span> <span class="n">obs2</span><span class="o">.</span><span class="n">point_id</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="c"># Calculate the two bearing angles of two observations.</span>
        <span class="n">b1</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">o</span><span class="o">.</span><span class="n">hz</span><span class="o">.</span><span class="n">get_angle</span><span class="p">()</span> <span class="o">+</span> <span class="n">obs1</span><span class="o">.</span><span class="n">hz</span><span class="o">.</span><span class="n">get_angle</span><span class="p">()</span>
        <span class="n">b2</span> <span class="o">=</span> <span class="n">s2</span><span class="o">.</span><span class="n">o</span><span class="o">.</span><span class="n">hz</span><span class="o">.</span><span class="n">get_angle</span><span class="p">()</span> <span class="o">+</span> <span class="n">obs2</span><span class="o">.</span><span class="n">hz</span><span class="o">.</span><span class="n">get_angle</span><span class="p">()</span>
        <span class="c"># Calculate an intersection point of two lines. If the two lines are parallels the function returns None object</span>
        <span class="n">pp</span> <span class="o">=</span> <span class="n">intersecLL</span><span class="p">(</span><span class="n">s1</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="n">s2</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pp</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="n">obs1</span><span class="o">.</span><span class="n">pc</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">pc</span> <span class="o">=</span> <span class="n">obs2</span><span class="o">.</span><span class="n">pc</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pc</span> <span class="o">=</span> <span class="n">obs1</span><span class="o">.</span><span class="n">pc</span>
        <span class="n">pp</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">obs1</span><span class="o">.</span><span class="n">point_id</span>
        <span class="n">pp</span><span class="o">.</span><span class="n">pc</span> <span class="o">=</span> <span class="n">pc</span>
        <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">+=</span> <span class="s">u&quot;</span><span class="si">%-10s</span><span class="s"> </span><span class="si">%-10s</span><span class="s"> </span><span class="si">%12.3f</span><span class="s"> </span><span class="si">%12.3f</span><span class="s"> </span><span class="si">%8.4f</span><span class="s"> </span><span class="si">%8.4f</span><span class="s">&quot;</span> <span class="o">%</span> \
                  <span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">pc</span> <span class="k">if</span> <span class="n">pp</span><span class="o">.</span><span class="n">pc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="s">&quot;-&quot;</span><span class="p">),</span> <span class="n">pp</span><span class="o">.</span><span class="n">e</span><span class="p">,</span> <span class="n">pp</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pp</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">resection</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">,</span> <span class="n">obs1</span><span class="p">,</span> <span class="n">obs2</span><span class="p">,</span> <span class="n">obs3</span><span class="p">):</span></div>
        <span class="sd">&quot;&quot;&quot; Calculate resection</span>
<div class="viewcode-block" id="Calculation.resection"><a class="viewcode-back" href="../../index.html#SurveyingCalculation.calculation.Calculation.resection">[docs]</a>
<span class="sd">            :param st: station (Station)</span>
<span class="sd">            :param p1: first control point (Point)</span>
<span class="sd">            :param p2: second control point (Point)</span>
<span class="sd">            :param p3: third control point (Point)</span>
<span class="sd">            :param obs1: observation from st to p1 (PolarObservation)</span>
<span class="sd">            :param obs2: observation from st to p2 (PolarObservation)</span>
<span class="sd">            :param obs3: observation from st to p3 (PolarObservation)</span>
<span class="sd">            :returns: coordinates of the resection point (Point) if it can be calculated; otherwise None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c"># Calculate angle between obs1 and obs2 and between obs2 and obs3.</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="n">Angle</span><span class="p">(</span><span class="n">obs2</span><span class="o">.</span><span class="n">hz</span><span class="o">.</span><span class="n">get_angle</span><span class="p">()</span> <span class="o">-</span> <span class="n">obs1</span><span class="o">.</span><span class="n">hz</span><span class="o">.</span><span class="n">get_angle</span><span class="p">())</span> <span class="c"># alpha</span>
            <span class="n">beta</span> <span class="o">=</span> <span class="n">Angle</span><span class="p">(</span><span class="n">obs3</span><span class="o">.</span><span class="n">hz</span><span class="o">.</span><span class="n">get_angle</span><span class="p">()</span> <span class="o">-</span> <span class="n">obs2</span><span class="o">.</span><span class="n">hz</span><span class="o">.</span><span class="n">get_angle</span><span class="p">())</span> <span class="c"># beta</span>
        
            <span class="c"># Create a circle on points p1 and p2 and alpha.</span>
            <span class="n">circ1</span> <span class="o">=</span> <span class="n">Circle</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
            <span class="c"># Create a circle on points p2 and p3 and beta.</span>
            <span class="n">circ2</span> <span class="o">=</span> <span class="n">Circle</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>
            <span class="c"># Calculate the intersection of two circles.</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">points</span> <span class="o">=</span> <span class="n">intersecCC</span><span class="p">(</span><span class="n">circ1</span><span class="p">,</span> <span class="n">circ2</span><span class="p">)</span>
            <span class="k">except</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">None</span>

            <span class="c"># IntersectCC functions can return with zero or two intersection points.</span>
            <span class="c"># If the number of intersection point is zero the resection method return None object.</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="c">#  Select the right one from the two intersection points.</span>
                <span class="k">if</span> <span class="n">math</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">p2</span><span class="o">.</span><span class="n">e</span> <span class="o">-</span> <span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">e</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.1</span> <span class="ow">and</span> <span class="n">math</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">p2</span><span class="o">.</span><span class="n">n</span> <span class="o">-</span> <span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">n</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">:</span>
                    <span class="n">p</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">e</span><span class="p">,</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="n">st</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">st</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">pc</span><span class="p">,</span> <span class="n">st</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">pt</span><span class="p">)</span>
                <span class="k">else</span> <span class="p">:</span>
                    <span class="n">p</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">e</span><span class="p">,</span> <span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="n">st</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">st</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">pc</span><span class="p">,</span> <span class="n">st</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">pt</span><span class="p">)</span>

                <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">+=</span> <span class="s">u&quot;</span><span class="si">%-10s</span><span class="s"> </span><span class="si">%-10s</span><span class="s"> </span><span class="si">%12.3f</span><span class="s"> </span><span class="si">%12.3f</span><span class="s">     </span><span class="si">%8.4f</span><span class="s">  </span><span class="si">%8.4f</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> \
                          <span class="p">(</span><span class="n">obs1</span><span class="o">.</span><span class="n">point_id</span><span class="p">,</span> <span class="p">(</span><span class="n">obs1</span><span class="o">.</span><span class="n">pc</span> <span class="k">if</span> <span class="n">obs1</span><span class="o">.</span><span class="n">pc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="s">&quot;-&quot;</span><span class="p">),</span> <span class="n">p1</span><span class="o">.</span><span class="n">e</span><span class="p">,</span> <span class="n">p1</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> \
                           <span class="n">obs1</span><span class="o">.</span><span class="n">hz</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&quot;GON&quot;</span><span class="p">),</span> <span class="n">alpha</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&quot;GON&quot;</span><span class="p">)</span> <span class="p">)</span>
                <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">+=</span> <span class="s">u&quot;</span><span class="si">%-10s</span><span class="s"> </span><span class="si">%-10s</span><span class="s"> </span><span class="si">%12.3f</span><span class="s"> </span><span class="si">%12.3f</span><span class="s">     </span><span class="si">%8.4f</span><span class="s">  </span><span class="si">%8.4f</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> \
                          <span class="p">(</span><span class="n">obs2</span><span class="o">.</span><span class="n">point_id</span><span class="p">,</span> <span class="p">(</span><span class="n">obs2</span><span class="o">.</span><span class="n">pc</span> <span class="k">if</span> <span class="n">obs2</span><span class="o">.</span><span class="n">pc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="s">&quot;-&quot;</span><span class="p">),</span> <span class="n">p2</span><span class="o">.</span><span class="n">e</span><span class="p">,</span> <span class="n">p2</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> \
                           <span class="n">obs2</span><span class="o">.</span><span class="n">hz</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&quot;GON&quot;</span><span class="p">),</span> <span class="n">beta</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&quot;GON&quot;</span><span class="p">)</span> <span class="p">)</span>
                <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">+=</span> <span class="s">u&quot;</span><span class="si">%-10s</span><span class="s"> </span><span class="si">%-10s</span><span class="s"> </span><span class="si">%12.3f</span><span class="s"> </span><span class="si">%12.3f</span><span class="s">     </span><span class="si">%8.4f</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> \
                          <span class="p">(</span><span class="n">obs3</span><span class="o">.</span><span class="n">point_id</span><span class="p">,</span> <span class="p">(</span><span class="n">obs3</span><span class="o">.</span><span class="n">pc</span> <span class="k">if</span> <span class="n">obs3</span><span class="o">.</span><span class="n">pc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="s">&quot;-&quot;</span><span class="p">),</span> <span class="n">p3</span><span class="o">.</span><span class="n">e</span><span class="p">,</span> <span class="n">p3</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> \
                           <span class="n">obs3</span><span class="o">.</span><span class="n">hz</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&quot;GON&quot;</span><span class="p">)</span> <span class="p">)</span>
                <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">+=</span> <span class="s">u&quot;</span><span class="si">%-10s</span><span class="s"> </span><span class="si">%-10s</span><span class="s"> </span><span class="si">%12.3f</span><span class="s"> </span><span class="si">%12.3f</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> \
                          <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">pc</span> <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">pc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="s">&quot;-&quot;</span><span class="p">),</span> <span class="n">p</span><span class="o">.</span><span class="n">e</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">p</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">None</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">None</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">traverse</span><span class="p">(</span><span class="n">trav_obs</span><span class="p">,</span> <span class="n">forceFree</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span></div>
        <span class="sd">&quot;&quot;&quot; Calculate traverse line. This method can compute the following types of travesres</span>
<div class="viewcode-block" id="Calculation.traverse"><a class="viewcode-back" href="../../index.html#SurveyingCalculation.calculation.Calculation.traverse">[docs]</a>
<span class="sd">            1. open traverse (free): originates at a known position with known bearings and ends at an unknown position</span>
<span class="sd">            2. closed traverse at both ends and the start point has known bearings</span>
<span class="sd">            3. closed traverse at both ends and both endpoints has known bearings</span>
<span class="sd">            4. inserted traverse: closed at both ends but no bearings</span>

<span class="sd">            :param trav_obs: a list of sublists consists of a Point and two PolarObservations, If the station member is not None the point is a station. Start point must have coordinates in case of type 1-4 and end points must have coordinates in case of type 2-4.  Two observations are needed at the angle points. At the start point the second observation is required in case of type 1-3. At the end point the first observation is required in case of type 3.</span>
<span class="sd">            :param forceFree: force free traverse calculation (Boole)</span>
<span class="sd">            :returns: a list of points which&#39;s coordinates has been computed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">trav_obs</span><span class="p">)</span>
        <span class="c"># at least 3 points must be</span>
        <span class="k">if</span> <span class="n">n</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">:</span>
            <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">+=</span> \
                <span class="n">tr</span><span class="p">(</span><span class="s">&quot;Error: At least 3 points must be added to traverse line!&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="c"># start point and end point</span>
        <span class="n">startp</span> <span class="o">=</span> <span class="n">trav_obs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">endp</span> <span class="o">=</span> <span class="n">trav_obs</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="c"># no coord for startpoint</span>
        <span class="k">if</span> <span class="n">startp</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">startp</span><span class="o">.</span><span class="n">p</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">startp</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">e</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">startp</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">n</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">+=</span> \
                <span class="n">tr</span><span class="p">(</span><span class="s">&quot;Error: No coordinates on start point!&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
            <span class="k">return</span> <span class="bp">None</span>
        
        <span class="n">free</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="n">forceFree</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="c"># force to calculate free traverse (for node)</span>
            <span class="n">free</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">endp</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">e</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="n">endp</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">elif</span> <span class="n">endp</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">endp</span><span class="o">.</span><span class="n">p</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">endp</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">e</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">endp</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">n</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c"># no coordinate for endpoint            </span>
            <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">+=</span> \
                <span class="n">tr</span><span class="p">(</span><span class="s">&quot;Warning: No coordinates for end point -&gt; Free traverse.&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> 
            <span class="n">free</span> <span class="o">=</span> <span class="bp">True</span> <span class="c"># free traverse</span>

        <span class="c">#collect measurements in traverse</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>
        <span class="n">t</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>
        <span class="n">t2</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
            <span class="n">st</span> <span class="o">=</span> <span class="n">trav_obs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">obsprev</span> <span class="o">=</span> <span class="n">trav_obs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">obsnext</span> <span class="o">=</span> <span class="n">trav_obs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">beta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">o</span><span class="o">.</span><span class="n">hz</span>
                <span class="k">if</span> <span class="n">beta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="c"># no orientation on start</span>
                    <span class="k">if</span> <span class="n">free</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
                        <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">+=</span> \
                            <span class="n">tr</span><span class="p">(</span><span class="s">&quot;Error: No orientation on start point and no coordinates on end point!&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
                        <span class="k">return</span> <span class="bp">None</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">+=</span> \
                            <span class="n">tr</span><span class="p">(</span><span class="s">&quot;Warning: No orientation on start point - inserted traverse.&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
                
            <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">beta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">o</span><span class="o">.</span><span class="n">hz</span>
                <span class="k">if</span> <span class="n">beta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="c"># no orientation on end</span>
                    <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">+=</span> \
                        <span class="n">tr</span><span class="p">(</span><span class="s">&quot;Warning: No orientation on end point.&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
            
            <span class="k">if</span> <span class="n">i</span><span class="o">!=</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">i</span><span class="o">!=</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="p">(</span><span class="n">obsprev</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">obsnext</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">obsprev</span><span class="o">.</span><span class="n">hz</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">obsnext</span><span class="o">.</span><span class="n">hz</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">):</span>
                <span class="c"># no angle at angle point</span>
                <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">+=</span> \
                    <span class="n">tr</span><span class="p">(</span><span class="s">&quot;Error: No angle at point </span><span class="si">%s</span><span class="s">!&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="n">trav_obs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">id</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
                <span class="k">return</span> <span class="bp">None</span>

            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c"># there was orientation on first</span>
                <span class="k">if</span> <span class="n">beta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">obsnext</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">obsnext</span><span class="o">.</span><span class="n">hz</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">beta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_angle</span><span class="p">(</span> <span class="n">beta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_angle</span><span class="p">()</span> <span class="o">+</span> <span class="n">obsnext</span><span class="o">.</span><span class="n">hz</span><span class="o">.</span><span class="n">get_angle</span><span class="p">()</span> <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">beta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">elif</span> <span class="n">i</span><span class="o">==</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">beta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">beta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">obsprev</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">obsprev</span><span class="o">.</span><span class="n">hz</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="c"># there was orientation on last and first</span>
                    <span class="n">beta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_angle</span><span class="p">(</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">beta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get_angle</span><span class="p">()</span> <span class="o">+</span> <span class="n">obsprev</span><span class="o">.</span><span class="n">hz</span><span class="o">.</span><span class="n">get_angle</span><span class="p">())</span> <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">beta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">beta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Angle</span><span class="p">(</span> <span class="n">obsnext</span><span class="o">.</span><span class="n">hz</span><span class="o">.</span><span class="n">get_angle</span><span class="p">()</span> <span class="o">-</span> <span class="n">obsprev</span><span class="o">.</span><span class="n">hz</span><span class="o">.</span><span class="n">get_angle</span><span class="p">()</span> <span class="p">)</span>
                
            <span class="k">if</span> <span class="n">beta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">while</span> <span class="n">beta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get_angle</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">beta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_angle</span><span class="p">(</span> <span class="n">beta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get_angle</span><span class="p">()</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span> <span class="p">)</span> 
                <span class="k">while</span> <span class="n">beta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get_angle</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">beta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_angle</span><span class="p">(</span> <span class="n">beta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get_angle</span><span class="p">()</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">2</span> <span class="p">)</span>
                    
            <span class="k">if</span> <span class="n">obsprev</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">obsprev</span><span class="o">.</span><span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="c"># save distance for output</span>
                    <span class="n">t1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Distance</span><span class="p">(</span><span class="n">obsprev</span><span class="o">.</span><span class="n">horiz_dist</span><span class="p">(),</span> <span class="s">&quot;HD&quot;</span><span class="p">)</span>
                    <span class="n">t2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="o">=</span> <span class="n">Distance</span><span class="p">((</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">d</span> <span class="o">+</span> <span class="n">obsprev</span><span class="o">.</span><span class="n">horiz_dist</span><span class="p">())</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span> <span class="s">&quot;HD&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Distance</span><span class="p">(</span><span class="n">obsprev</span><span class="o">.</span><span class="n">horiz_dist</span><span class="p">(),</span><span class="s">&quot;HD&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">i</span><span class="o">&gt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="c"># no distance between points</span>
                <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">+=</span> \
                    <span class="n">tr</span><span class="p">(</span><span class="s">&quot;Error: No distance between points </span><span class="si">%s</span><span class="s"> and </span><span class="si">%s</span><span class="s">!&quot;</span><span class="p">)</span> <span class="o">%</span> \
                    <span class="p">(</span><span class="n">trav_obs</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">id</span><span class="p">,</span><span class="n">trav_obs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
                <span class="k">return</span> <span class="bp">None</span>
            
            <span class="k">if</span> <span class="n">obsnext</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">obsnext</span><span class="o">.</span><span class="n">d</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Distance</span><span class="p">(</span><span class="n">obsnext</span><span class="o">.</span><span class="n">horiz_dist</span><span class="p">(),</span><span class="s">&quot;HD&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">forceFree</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">beta</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="c"># calculate sum of betas if we have both orientation</span>
        <span class="k">if</span> <span class="n">beta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">beta</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">sumbeta</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c"># in radians</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
                <span class="n">sumbeta</span> <span class="o">=</span> <span class="n">sumbeta</span> <span class="o">+</span> <span class="n">beta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get_angle</span><span class="p">()</span>
            <span class="c"># calculate angle error</span>
            <span class="n">dbeta</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="n">sumbeta</span> <span class="c"># in radians</span>
            <span class="k">while</span> <span class="n">dbeta</span> <span class="o">&gt;</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span>
                <span class="n">dbeta</span> <span class="o">=</span> <span class="n">dbeta</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span>
            <span class="k">while</span> <span class="n">dbeta</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span>
                <span class="n">dbeta</span> <span class="o">=</span> <span class="n">dbeta</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sumbeta</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">dbeta</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="c"># angle corrections</span>
        <span class="n">w</span> <span class="o">=</span> <span class="mf">0.0</span>   <span class="c"># in seconds</span>
        <span class="n">vbeta</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>  <span class="c"># in seconds</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
            <span class="n">vbeta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dbeta</span> <span class="o">/</span> <span class="n">n</span>
            <span class="n">w</span> <span class="o">=</span> <span class="n">w</span> <span class="o">+</span> <span class="n">vbeta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="c">#    calculate bearings and de &amp; dn for sides</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span><span class="o">*</span><span class="n">n</span> <span class="c"># in radians</span>
        <span class="n">sumde</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">sumdn</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">sumt</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">de</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>
        <span class="n">dn</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>

            <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">j</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">beta</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">d</span> <span class="o">=</span> <span class="n">delta</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">beta</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">get_angle</span><span class="p">()</span> <span class="o">+</span> <span class="n">vbeta</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c"># find orientation for first side &quot;beillesztett&quot;</span>
                    <span class="n">d</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">sumde</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">sumdn</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
                        <span class="n">de</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">d</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
                        <span class="n">dn</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">d</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
                        <span class="n">sumde</span> <span class="o">=</span> <span class="n">sumde</span> <span class="o">+</span> <span class="n">de</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="n">sumdn</span> <span class="o">=</span> <span class="n">sumdn</span> <span class="o">+</span> <span class="n">dn</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">d</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="n">beta</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">get_angle</span><span class="p">()</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span>
                    
                    <span class="n">d</span> <span class="o">=</span> <span class="n">bearing</span><span class="p">(</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;@&quot;</span><span class="p">,</span><span class="n">endp</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">e</span><span class="p">,</span> <span class="n">endp</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">n</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;@&quot;</span><span class="p">,</span><span class="n">startp</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">e</span><span class="p">,</span><span class="n">startp</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">n</span><span class="p">))</span><span class="o">.</span><span class="n">get_angle</span><span class="p">()</span> <span class="o">-</span> \
                            <span class="n">bearing</span> <span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="s">&quot;@&quot;</span><span class="p">,</span><span class="n">sumde</span><span class="p">,</span><span class="n">sumdn</span><span class="p">),</span><span class="n">Point</span><span class="p">(</span><span class="s">&quot;@&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">get_angle</span><span class="p">()</span>
                    <span class="n">sumde</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">sumdn</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">d</span> <span class="o">=</span> <span class="n">delta</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">beta</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">get_angle</span><span class="p">()</span> <span class="o">+</span> <span class="n">vbeta</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span>
            
            <span class="k">while</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">d</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">2</span>
            <span class="k">while</span> <span class="n">d</span> <span class="o">&gt;</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">2</span><span class="p">:</span>
                <span class="n">d</span> <span class="o">=</span> <span class="n">d</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">2</span>
            <span class="n">delta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span>
            <span class="n">de</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">d</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
            <span class="n">dn</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">d</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
            <span class="n">sumde</span> <span class="o">=</span> <span class="n">sumde</span> <span class="o">+</span> <span class="n">de</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">sumdn</span> <span class="o">=</span> <span class="n">sumdn</span> <span class="o">+</span> <span class="n">dn</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">sumt</span> <span class="o">=</span> <span class="n">sumt</span> <span class="o">+</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">d</span>
            
        <span class="c">#    calculate de &amp; dn error</span>
        <span class="k">if</span> <span class="n">free</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">dde</span> <span class="o">=</span> <span class="mi">0</span> <span class="c"># free traverse</span>
            <span class="n">ddn</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">ddist</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dde</span> <span class="o">=</span> <span class="n">endp</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">e</span> <span class="o">-</span> <span class="n">startp</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">e</span> <span class="o">-</span> <span class="n">sumde</span>
            <span class="n">ddn</span> <span class="o">=</span> <span class="n">endp</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">n</span> <span class="o">-</span> <span class="n">startp</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">n</span> <span class="o">-</span> <span class="n">sumdn</span>
            <span class="n">ddist</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">dde</span><span class="p">,</span> <span class="n">ddn</span><span class="p">)</span>    <span class="c"># linear error</span>

        <span class="c">#    calculate final coords</span>
        <span class="n">ve</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>
        <span class="n">vn</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>
        <span class="n">ee</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>
        <span class="n">nn</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">n</span>
        <span class="n">we</span> <span class="o">=</span> <span class="n">dde</span> <span class="o">/</span> <span class="n">sumt</span>
        <span class="n">wn</span> <span class="o">=</span> <span class="n">ddn</span> <span class="o">/</span> <span class="n">sumt</span>
        <span class="n">ee</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">startp</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">e</span>
        <span class="n">nn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">startp</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">n</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
            <span class="n">ve</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">d</span> <span class="o">*</span> <span class="n">we</span>
            <span class="n">vn</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">d</span> <span class="o">*</span> <span class="n">wn</span>
            <span class="n">ee</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ee</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">de</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">ve</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">nn</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">nn</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dn</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">vn</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
            <span class="n">pcode</span> <span class="o">=</span> <span class="p">(</span><span class="n">trav_obs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">pc</span> <span class="k">if</span> <span class="n">trav_obs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">pc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="s">&quot;-&quot;</span><span class="p">)</span>
            <span class="n">t_1</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%8.3f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">t1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">d</span> <span class="k">if</span> <span class="n">t1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="s">&quot;-&quot;</span>
            <span class="n">t_2</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%8.3f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">t2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">d</span> <span class="k">if</span> <span class="n">t2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="k">else</span> <span class="s">&quot;-&quot;</span>
            <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">+=</span> <span class="s">&quot;           </span><span class="si">%10.4f</span><span class="s"> </span><span class="si">%8s</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Angle</span><span class="p">(</span><span class="n">delta</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&quot;GON&quot;</span><span class="p">),</span> <span class="n">t_1</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">beta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">+=</span> <span class="s">u&quot;</span><span class="si">%-10s</span><span class="s"> </span><span class="si">%10s</span><span class="s"> </span><span class="si">%8.3f</span><span class="s"> </span><span class="si">%8.3f</span><span class="s"> </span><span class="si">%8.3f</span><span class="s"> </span><span class="si">%10.3f</span><span class="s"> </span><span class="si">%10.3f</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> \
                             <span class="p">(</span><span class="n">trav_obs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> \
                             <span class="n">de</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dn</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">de</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ve</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">dn</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">vn</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">+=</span> <span class="s">u&quot;</span><span class="si">%-10s</span><span class="s"> </span><span class="si">%10.4f</span><span class="s"> </span><span class="si">%8.3f</span><span class="s"> </span><span class="si">%8.3f</span><span class="s"> </span><span class="si">%8.3f</span><span class="s"> </span><span class="si">%10.3f</span><span class="s"> </span><span class="si">%10.3f</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> \
                             <span class="p">(</span><span class="n">trav_obs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">beta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&#39;GON&#39;</span><span class="p">),</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> \
                             <span class="n">de</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dn</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">de</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ve</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">dn</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">vn</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">beta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">+=</span> <span class="s">u&quot;</span><span class="si">%-10s</span><span class="s"> </span><span class="si">%10s</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> \
                             <span class="p">(</span><span class="n">trav_obs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">+=</span> <span class="s">u&quot;</span><span class="si">%-10s</span><span class="s"> </span><span class="si">%10.4f</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> \
                             <span class="p">(</span><span class="n">trav_obs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">beta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&#39;GON&#39;</span><span class="p">))</span>
            
            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">free</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
                    <span class="n">w1</span> <span class="o">=</span> <span class="s">&quot;-&quot;</span>
                    <span class="n">w2</span> <span class="o">=</span> <span class="s">&quot;-&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">w1</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%8.3f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">ve</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">w2</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%8.3f</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">vn</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">beta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">beta</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">+=</span> <span class="s">u&quot;</span><span class="si">%-10s</span><span class="s"> </span><span class="si">%10s</span><span class="s"> </span><span class="si">%8s</span><span class="s"> </span><span class="si">%8s</span><span class="s"> </span><span class="si">%8s</span><span class="s"> </span><span class="si">%10.3f</span><span class="s"> </span><span class="si">%10.3f</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> \
                             <span class="p">(</span><span class="n">pcode</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">t_2</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">ee</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">nn</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">+=</span> <span class="s">u&quot;</span><span class="si">%-10s</span><span class="s"> </span><span class="si">%10.4f</span><span class="s"> </span><span class="si">%8s</span><span class="s"> </span><span class="si">%8.3f</span><span class="s"> </span><span class="si">%8.3f</span><span class="s"> </span><span class="si">%10.3f</span><span class="s"> </span><span class="si">%10.3f</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> \
                             <span class="p">(</span><span class="n">pcode</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="n">vbeta</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&#39;GON&#39;</span><span class="p">),</span> <span class="n">t_2</span><span class="p">,</span> <span class="n">ve</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">vn</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ee</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">nn</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">beta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">beta</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">+=</span> <span class="s">u&quot;</span><span class="si">%-10s</span><span class="s"> </span><span class="si">%10s</span><span class="s">                           </span><span class="si">%10.3f</span><span class="s"> </span><span class="si">%10.3f</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> \
                             <span class="p">(</span><span class="n">pcode</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ee</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">nn</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">+=</span> <span class="s">u&quot;</span><span class="si">%-10s</span><span class="s"> </span><span class="si">%10.4s</span><span class="s">                           </span><span class="si">%10.3f</span><span class="s"> </span><span class="si">%10.3f</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> \
                             <span class="p">(</span><span class="n">pcode</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="n">vbeta</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&#39;GON&#39;</span><span class="p">),</span> <span class="n">ee</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">nn</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">pass</span>

        <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">+=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
        <span class="k">if</span> <span class="n">beta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">beta</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">+=</span> <span class="s">&quot;           </span><span class="si">%10s</span><span class="s">                            </span><span class="si">%10.3f</span><span class="s"> </span><span class="si">%10.3f</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> \
                     <span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">ee</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">ee</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nn</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">nn</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">+=</span> <span class="s">&quot;           </span><span class="si">%10s</span><span class="s"> </span><span class="si">%8.3f</span><span class="s"> </span><span class="si">%8.3f</span><span class="s"> </span><span class="si">%8.3f</span><span class="se">\n\n</span><span class="s">&quot;</span> <span class="o">%</span> \
                     <span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">sumt</span><span class="p">,</span> <span class="n">sumde</span><span class="p">,</span> <span class="n">sumdn</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">free</span><span class="p">:</span>
                <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">+=</span> <span class="s">&quot;           </span><span class="si">%10s</span><span class="s">          </span><span class="si">%8.3f</span><span class="s"> </span><span class="si">%8.3f</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">dde</span><span class="p">,</span><span class="n">ddn</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">+=</span> <span class="s">&quot;           </span><span class="si">%10.4s</span><span class="s">                            </span><span class="si">%10.3f</span><span class="s"> </span><span class="si">%10.3f</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> \
                     <span class="p">(</span><span class="n">Angle</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&#39;GON&#39;</span><span class="p">),</span> <span class="n">ee</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">ee</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nn</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">nn</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">+=</span> <span class="s">&quot;           </span><span class="si">%10.4s</span><span class="s"> </span><span class="si">%8.3f</span><span class="s"> </span><span class="si">%8.3f</span><span class="s"> </span><span class="si">%8.3f</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> \
                     <span class="p">(</span><span class="n">Angle</span><span class="p">(</span><span class="n">sumbeta</span><span class="p">)</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&#39;GON&#39;</span><span class="p">),</span><span class="n">sumt</span><span class="p">,</span><span class="n">sumde</span><span class="p">,</span><span class="n">sumdn</span><span class="p">)</span>
            <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">+=</span> <span class="s">&quot;           </span><span class="si">%10.4f</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> \
                     <span class="p">(</span><span class="n">Angle</span><span class="p">((</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&#39;GON&#39;</span><span class="p">))</span>
            <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">+=</span> <span class="s">&quot;           </span><span class="si">%10.4s</span><span class="s">          </span><span class="si">%8.3f</span><span class="s"> </span><span class="si">%8.3f</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> \
                     <span class="p">(</span><span class="n">Angle</span><span class="p">(</span><span class="n">dbeta</span><span class="p">)</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&#39;GON&#39;</span><span class="p">),</span> <span class="n">dde</span><span class="p">,</span> <span class="n">ddn</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">free</span><span class="p">:</span>
            <span class="n">ResultLog</span><span class="o">.</span><span class="n">resultlog_message</span> <span class="o">+=</span> <span class="s">&quot;                                   </span><span class="si">%8.3f</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">ddist</span>
     
        <span class="k">if</span> <span class="n">free</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">last</span> <span class="o">=</span> <span class="n">n</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">last</span> <span class="o">=</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span>
        <span class="n">plist</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c"># list of calculated points</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">last</span><span class="p">):</span>
            
            <span class="k">if</span> <span class="n">trav_obs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">trav_obs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">p</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">plist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">trav_obs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">p</span> <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">Point</span><span class="p">(</span> <span class="n">trav_obs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">o</span><span class="o">.</span><span class="n">point_id</span><span class="p">)</span> <span class="p">)</span>
            <span class="n">plist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">e</span> <span class="o">=</span> <span class="n">ee</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">plist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">nn</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">plist</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">gauss_elimination</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span></div>
        <span class="sd">&quot;&quot;&quot; Solve a linear equation system::</span>
<div class="viewcode-block" id="Calculation.gauss_elimination"><a class="viewcode-back" href="../../index.html#SurveyingCalculation.calculation.Calculation.gauss_elimination">[docs]</a><span class="sd">                a * x = b</span>

<span class="sd">            :param a: coefficients of the equation system (list of lists)</span>
<span class="sd">            :param b: list of pure term of equations</span>
<span class="sd">            :returns: (unknowns, inverse_matrix)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">size</span><span class="p">):</span>
            <span class="n">q</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">size</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">k</span><span class="p">:</span>
                    <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">q</span> <span class="o">*</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">q</span>
        
            <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">q</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">size</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">j</span> <span class="o">!=</span> <span class="n">i</span><span class="p">:</span>
                    <span class="n">t</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">size</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">k</span> <span class="p">:</span>
                            <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span> <span class="o">*</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">t</span> <span class="o">*</span> <span class="n">q</span>
                    <span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">orthogonal_transformation</span><span class="p">(</span><span class="n">plist</span><span class="p">):</span></div>
        <span class="sd">&quot;&quot;&quot; Calculate parameters of orthogonal transformation. Four parameters scale, rotation and offset.::</span>
<div class="viewcode-block" id="Calculation.orthogonal_transformation"><a class="viewcode-back" href="../../index.html#SurveyingCalculation.calculation.Calculation.orthogonal_transformation">[docs]</a><span class="sd">            E = E0 + c * e - d * n</span>
<span class="sd">            N = N0 + d * e + c * n</span>

<span class="sd">            :param plist: a list of common points used in the transormation plist[i]==[srci,desti]</span>
<span class="sd">            :returns: the list of transformation parameters {E0 N0 c d}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">es</span> <span class="o">=</span> <span class="mf">0.0</span>    <span class="c"># sum of source coordinates</span>
        <span class="n">ns</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">Es</span> <span class="o">=</span> <span class="mf">0.0</span>    <span class="c"># sum of destination coordinates</span>
        <span class="n">Ns</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">plist</span><span class="p">:</span>
            <span class="n">es</span> <span class="o">=</span> <span class="n">es</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">e</span>
            <span class="n">ns</span> <span class="o">=</span> <span class="n">ns</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">n</span>
            <span class="n">Es</span> <span class="o">=</span> <span class="n">Es</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">e</span>
            <span class="n">Ns</span> <span class="o">=</span> <span class="n">Ns</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">n</span>

        <span class="n">ew</span> <span class="o">=</span> <span class="n">es</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">plist</span><span class="p">))</span>
        <span class="n">nw</span> <span class="o">=</span> <span class="n">ns</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">plist</span><span class="p">))</span>
        <span class="n">Ew</span> <span class="o">=</span> <span class="n">Es</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">plist</span><span class="p">))</span>
        <span class="n">Nw</span> <span class="o">=</span> <span class="n">Ns</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">plist</span><span class="p">))</span>

        <span class="n">s1</span> <span class="o">=</span> <span class="mf">0.0</span>    <span class="c"># sum of ei*Ei+ni*Ni</span>
        <span class="n">s2</span> <span class="o">=</span> <span class="mf">0.0</span>    <span class="c"># sum of ei*Ni-ni*Ei</span>
        <span class="n">s3</span> <span class="o">=</span> <span class="mf">0.0</span>    <span class="c"># sum of ei*ei+ni*ni</span>
   
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">plist</span><span class="p">:</span>
            <span class="n">e</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">e</span> <span class="o">-</span> <span class="n">ew</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">n</span> <span class="o">-</span> <span class="n">nw</span>
            <span class="n">E</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">e</span> <span class="o">-</span> <span class="n">Ew</span>
            <span class="n">N</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">n</span> <span class="o">-</span> <span class="n">Nw</span>
            <span class="n">s1</span> <span class="o">=</span> <span class="n">s1</span> <span class="o">+</span> <span class="n">e</span> <span class="o">*</span> <span class="n">E</span> <span class="o">+</span> <span class="n">n</span> <span class="o">*</span> <span class="n">N</span>
            <span class="n">s2</span> <span class="o">=</span> <span class="n">s2</span> <span class="o">+</span> <span class="n">e</span> <span class="o">*</span> <span class="n">N</span> <span class="o">-</span> <span class="n">n</span> <span class="o">*</span> <span class="n">E</span>
            <span class="n">s3</span> <span class="o">=</span> <span class="n">s3</span> <span class="o">+</span> <span class="n">e</span> <span class="o">*</span> <span class="n">e</span> <span class="o">+</span> <span class="n">n</span> <span class="o">*</span> <span class="n">n</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">s1</span> <span class="o">/</span> <span class="n">s3</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">s2</span> <span class="o">/</span> <span class="n">s3</span>
        <span class="n">E0</span> <span class="o">=</span> <span class="p">(</span><span class="n">Es</span> <span class="o">-</span> <span class="n">c</span> <span class="o">*</span> <span class="n">es</span> <span class="o">+</span> <span class="n">d</span> <span class="o">*</span> <span class="n">ns</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">plist</span><span class="p">))</span>
        <span class="n">N0</span> <span class="o">=</span> <span class="p">(</span><span class="n">Ns</span> <span class="o">-</span> <span class="n">c</span> <span class="o">*</span> <span class="n">ns</span> <span class="o">-</span> <span class="n">d</span> <span class="o">*</span> <span class="n">es</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">plist</span><span class="p">))</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">E0</span><span class="p">,</span> <span class="n">N0</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">]</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">orthogonal3tr</span><span class="p">(</span><span class="n">plist</span><span class="p">):</span></div>
        <span class="sd">&quot;&quot;&quot; Calculate parameters of orthogonal transformation. Three parameters::</span>
<div class="viewcode-block" id="Calculation.orthogonal3tr"><a class="viewcode-back" href="../../index.html#SurveyingCalculation.calculation.Calculation.orthogonal3tr">[docs]</a>
<span class="sd">            E = E0 + cos(alpha) * e - sin(alpha) * n</span>
<span class="sd">            N = N0 + sin(alpha) * e + cos(alpha) * n</span>

<span class="sd">            :param plist: a list of common points used in the transormation plist[i]==[srci,desti]</span>
<span class="sd">            :returns: the list of transformation parameters {E0 N0 alpha}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># approximate values from Helmert4</span>
        <span class="n">appr</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">orthogonal_transformation</span><span class="p">(</span><span class="n">plist</span><span class="p">)</span>
        <span class="n">E0</span> <span class="o">=</span> <span class="n">appr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">N0</span> <span class="o">=</span> <span class="n">appr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">appr</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">appr</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

        <span class="c"># calculate sums</span>
        <span class="n">s1</span> <span class="o">=</span> <span class="mf">0.0</span>    <span class="c"># -ei*sin(alpha) - ni*cos(alpha)</span>
        <span class="n">s2</span> <span class="o">=</span> <span class="mf">0.0</span>    <span class="c">#  ei*cos(alpha) - ni*sin(alpha)</span>
        <span class="n">s3</span> <span class="o">=</span> <span class="mf">0.0</span>    <span class="c"># (-ei*sin(alpha) - ni*cos(alpha))^2 + \</span>
                    <span class="c"># ( ei*cos(alpha) - ni*sin(alpha))^2</span>
        <span class="n">s4</span> <span class="o">=</span> <span class="mf">0.0</span>    <span class="c"># Ei - Eei</span>
        <span class="n">s5</span> <span class="o">=</span> <span class="mf">0.0</span>    <span class="c"># Ni - Nei</span>
        <span class="n">s6</span> <span class="o">=</span> <span class="mf">0.0</span>    <span class="c"># (-ei*sin(alpha) - ni*cos(alpha)) * (Ei-Eei) +</span>
                    <span class="c"># ( ei*cos(alpha) - ni*sin(alpha)) * (Ni-Nei)</span>
    
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">plist</span><span class="p">:</span>
            <span class="n">e</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">e</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">n</span>
            <span class="n">E</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">e</span>
            <span class="n">N</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">n</span>
            <span class="n">w1</span> <span class="o">=</span> <span class="o">-</span><span class="n">e</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span> <span class="o">-</span> <span class="n">n</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
            <span class="n">w2</span> <span class="o">=</span> <span class="n">e</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span> <span class="o">-</span> <span class="n">n</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
            <span class="n">s1</span> <span class="o">=</span> <span class="n">s1</span> <span class="o">+</span> <span class="n">w1</span>
            <span class="n">s2</span> <span class="o">=</span> <span class="n">s2</span> <span class="o">+</span> <span class="n">w2</span>
            <span class="n">s3</span> <span class="o">=</span> <span class="n">s3</span> <span class="o">+</span> <span class="n">w1</span> <span class="o">*</span> <span class="n">w1</span> <span class="o">+</span> <span class="n">w2</span> <span class="o">*</span> <span class="n">w2</span>
        
            <span class="n">w3</span> <span class="o">=</span> <span class="n">E</span> <span class="o">-</span> <span class="p">(</span><span class="n">E0</span> <span class="o">+</span> <span class="n">e</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span> <span class="o">-</span> <span class="n">n</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span>
            <span class="n">w4</span> <span class="o">=</span> <span class="n">N</span> <span class="o">-</span> <span class="p">(</span><span class="n">N0</span> <span class="o">+</span> <span class="n">e</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span> <span class="o">+</span> <span class="n">n</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span>
            <span class="n">s4</span> <span class="o">=</span> <span class="n">s4</span> <span class="o">+</span> <span class="n">w3</span>
            <span class="n">s5</span> <span class="o">=</span> <span class="n">s5</span> <span class="o">+</span> <span class="n">w4</span>
            <span class="n">s6</span> <span class="o">=</span> <span class="n">s6</span> <span class="o">+</span> <span class="n">w1</span> <span class="o">*</span> <span class="n">w3</span> <span class="o">+</span> <span class="n">w2</span> <span class="o">*</span> <span class="n">w4</span>

        <span class="c"># set matrix of normal equation</span>
        <span class="n">ata</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">ata</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">plist</span><span class="p">)</span>
        <span class="n">ata</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">ata</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">s1</span>
        <span class="n">ata</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">ata</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">plist</span><span class="p">)</span>
        <span class="n">ata</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">s2</span>
        <span class="n">ata</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">s1</span>
        <span class="n">ata</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">s2</span>
        <span class="n">ata</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">s3</span>
        <span class="c"># set A*l</span>
        <span class="n">al</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">al</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">s4</span>
        <span class="n">al</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">s5</span>
        <span class="n">al</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">s6</span>
        <span class="c"># solve the normal equation</span>
        <span class="n">Calculation</span><span class="o">.</span><span class="n">gauss_elimination</span><span class="p">(</span><span class="n">ata</span><span class="p">,</span> <span class="n">al</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">[</span> <span class="n">E0</span> <span class="o">+</span> <span class="n">al</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">N0</span> <span class="o">+</span> <span class="n">al</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">alpha</span> <span class="o">+</span> <span class="n">al</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">]</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">affine_transformation</span><span class="p">(</span><span class="n">plist</span><span class="p">):</span></div>
        <span class="sd">&quot;&quot;&quot; Calculate parameters of affine transformation. Six parameters::</span>
<div class="viewcode-block" id="Calculation.affine_transformation"><a class="viewcode-back" href="../../index.html#SurveyingCalculation.calculation.Calculation.affine_transformation">[docs]</a><span class="sd">            E = E0 + a * e + b * n</span>
<span class="sd">            N = N0 + c * e + d * n</span>

<span class="sd">            :param plist: a list of common points used in the transormation plist[i]==[srci,desti]</span>
<span class="sd">            :returns: the list of transformation parameters {E0 N0 a b c d}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># calculate weight point in point list</span>
        <span class="n">es</span> <span class="o">=</span> <span class="mf">0.0</span>    <span class="c"># sum of source coordinates</span>
        <span class="n">ns</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">Es</span> <span class="o">=</span> <span class="mf">0.0</span>    <span class="c"># sum of destination coordinates</span>
        <span class="n">Ns</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">plist</span><span class="p">:</span>
            <span class="n">es</span> <span class="o">=</span> <span class="n">es</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">e</span>
            <span class="n">ns</span> <span class="o">=</span> <span class="n">ns</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">n</span>
            <span class="n">Es</span> <span class="o">=</span> <span class="n">Es</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">e</span>
            <span class="n">Ns</span> <span class="o">=</span> <span class="n">Ns</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">n</span>
    
        <span class="n">ew</span> <span class="o">=</span> <span class="n">es</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">plist</span><span class="p">))</span>
        <span class="n">nw</span> <span class="o">=</span> <span class="n">ns</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">plist</span><span class="p">))</span>
        <span class="n">Ew</span> <span class="o">=</span> <span class="n">Es</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">plist</span><span class="p">))</span>
        <span class="n">Nw</span> <span class="o">=</span> <span class="n">Ns</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">plist</span><span class="p">))</span>

        <span class="n">s1</span> <span class="o">=</span> <span class="mf">0.0</span>    <span class="c"># sum of ei*ei</span>
        <span class="n">s2</span> <span class="o">=</span> <span class="mf">0.0</span>    <span class="c"># sum of ni*ni</span>
        <span class="n">s3</span> <span class="o">=</span> <span class="mf">0.0</span>    <span class="c"># sum of ei*ni</span>
        <span class="n">s4</span> <span class="o">=</span> <span class="mf">0.0</span>    <span class="c"># sum of ei*Ei</span>
        <span class="n">s5</span> <span class="o">=</span> <span class="mf">0.0</span>    <span class="c"># sum of ni*Ei</span>
        <span class="n">s6</span> <span class="o">=</span> <span class="mf">0.0</span>    <span class="c"># sum of ei*Ni</span>
        <span class="n">s7</span> <span class="o">=</span> <span class="mf">0.0</span>    <span class="c"># sum of ni*Ni</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">plist</span><span class="p">:</span>
            <span class="n">e</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">e</span> <span class="o">-</span> <span class="n">ew</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">n</span> <span class="o">-</span> <span class="n">nw</span>
            <span class="n">E</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">e</span> <span class="o">-</span> <span class="n">Ew</span>
            <span class="n">N</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">n</span> <span class="o">-</span> <span class="n">Nw</span>
            <span class="n">s1</span> <span class="o">=</span> <span class="n">s1</span> <span class="o">+</span> <span class="n">e</span> <span class="o">*</span> <span class="n">e</span>
            <span class="n">s2</span> <span class="o">=</span> <span class="n">s2</span> <span class="o">+</span> <span class="n">n</span> <span class="o">*</span> <span class="n">n</span>
            <span class="n">s3</span> <span class="o">=</span> <span class="n">s3</span> <span class="o">+</span> <span class="n">e</span> <span class="o">*</span> <span class="n">n</span>
            <span class="n">s4</span> <span class="o">=</span> <span class="n">s4</span> <span class="o">+</span> <span class="n">e</span> <span class="o">*</span> <span class="n">E</span>
            <span class="n">s5</span> <span class="o">=</span> <span class="n">s5</span> <span class="o">+</span> <span class="n">n</span> <span class="o">*</span> <span class="n">E</span>
            <span class="n">s6</span> <span class="o">=</span> <span class="n">s6</span> <span class="o">+</span> <span class="n">e</span> <span class="o">*</span> <span class="n">N</span>
            <span class="n">s7</span> <span class="o">=</span> <span class="n">s7</span> <span class="o">+</span> <span class="n">n</span> <span class="o">*</span> <span class="n">N</span>

        <span class="n">w</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">s1</span> <span class="o">*</span> <span class="n">s2</span> <span class="o">-</span> <span class="n">s3</span> <span class="o">*</span> <span class="n">s3</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">s5</span> <span class="o">*</span> <span class="n">s3</span> <span class="o">-</span> <span class="n">s4</span> <span class="o">*</span> <span class="n">s2</span><span class="p">)</span> <span class="o">/</span> <span class="n">w</span>
        <span class="n">b</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">s4</span> <span class="o">*</span> <span class="n">s3</span> <span class="o">-</span> <span class="n">s1</span> <span class="o">*</span> <span class="n">s5</span><span class="p">)</span> <span class="o">/</span> <span class="n">w</span>
        <span class="n">c</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">s7</span> <span class="o">*</span> <span class="n">s3</span> <span class="o">-</span> <span class="n">s6</span> <span class="o">*</span> <span class="n">s2</span><span class="p">)</span> <span class="o">/</span> <span class="n">w</span>
        <span class="n">d</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">s6</span> <span class="o">*</span> <span class="n">s3</span> <span class="o">-</span> <span class="n">s7</span> <span class="o">*</span> <span class="n">s1</span><span class="p">)</span> <span class="o">/</span> <span class="n">w</span>
        <span class="n">E0</span> <span class="o">=</span> <span class="p">(</span><span class="n">Es</span> <span class="o">-</span> <span class="n">a</span> <span class="o">*</span> <span class="n">es</span> <span class="o">-</span> <span class="n">b</span> <span class="o">*</span> <span class="n">ns</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">plist</span><span class="p">))</span>
        <span class="n">N0</span> <span class="o">=</span> <span class="p">(</span><span class="n">Ns</span> <span class="o">-</span> <span class="n">c</span> <span class="o">*</span> <span class="n">es</span> <span class="o">-</span> <span class="n">d</span> <span class="o">*</span> <span class="n">ns</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">plist</span><span class="p">))</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">E0</span><span class="p">,</span> <span class="n">N0</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">]</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">polynomial_transformation</span><span class="p">(</span><span class="n">plist</span><span class="p">,</span> <span class="n">degree</span> <span class="o">=</span> <span class="mi">3</span><span class="p">):</span></div>
        <span class="sd">&quot;&quot;&quot; Calculate parameters of polynomial (rubber sheet) transformation.::</span>
<div class="viewcode-block" id="Calculation.polynomial_transformation"><a class="viewcode-back" href="../../index.html#SurveyingCalculation.calculation.Calculation.polynomial_transformation">[docs]</a>
<span class="sd">            X = X0 + a1 * x + a2 * y + a3 * xy + a4 * x^2 + a5 * y^2 + ...</span>
<span class="sd">            Y = Y0 + b1 * x + b2 * y + b3 * xy + b4 * x^2 + b5 * y^2 + ...</span>

<span class="sd">            :param plist: a list of common points used in the transformation plist[i]==[srci,desti]</span>
<span class="sd">            :param degree: degree of transformation 3/4/5</span>
<span class="sd">            :returns: the list of parameters X0 Y0 a1 b1 a2 b2 a3 b3 ...  and the weight point coordinates in source and target system</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># set up A matrix (a1 for e, a2 for n)</span>
        <span class="n">np</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">plist</span><span class="p">)</span>     <span class="c"># number of points</span>
        <span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="n">degree</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">degree</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>    <span class="c"># number of unknowns</span>
        <span class="c"># calculate average x and y to reduce rounding errors</span>
        <span class="n">s1</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">s2</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">S1</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">S2</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">plist</span><span class="p">:</span>
            <span class="n">e</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">e</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">n</span>
            <span class="n">s1</span> <span class="o">=</span> <span class="n">s1</span> <span class="o">+</span> <span class="n">e</span>
            <span class="n">s2</span> <span class="o">=</span> <span class="n">s2</span> <span class="o">+</span> <span class="n">n</span>
            <span class="n">E</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">e</span>
            <span class="n">N</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">n</span>
            <span class="n">S1</span> <span class="o">=</span> <span class="n">S1</span> <span class="o">+</span> <span class="n">E</span>
            <span class="n">S2</span> <span class="o">=</span> <span class="n">S2</span> <span class="o">+</span> <span class="n">N</span>
        <span class="n">avge</span> <span class="o">=</span> <span class="n">s1</span> <span class="o">/</span> <span class="n">np</span>
        <span class="n">avgn</span> <span class="o">=</span> <span class="n">s2</span> <span class="o">/</span> <span class="n">np</span>
        <span class="n">avgE</span> <span class="o">=</span> <span class="n">S1</span> <span class="o">/</span> <span class="n">np</span>
        <span class="n">avgN</span> <span class="o">=</span> <span class="n">S2</span> <span class="o">/</span> <span class="n">n</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">a1</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">)]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="p">)]</span>
        <span class="n">a2</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">)]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="p">)]</span>
        <span class="n">l1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="p">)]</span>
        <span class="n">l2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">plist</span><span class="p">:</span>
            <span class="n">e</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">e</span> <span class="o">-</span> <span class="n">avge</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">n</span> <span class="o">-</span> <span class="n">avgn</span>
            <span class="n">E</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">e</span> <span class="o">-</span> <span class="n">avgE</span>
            <span class="n">N</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">n</span> <span class="o">-</span> <span class="n">avgN</span>
            <span class="n">l</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">degree</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">degree</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">j</span> <span class="o">+</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">degree</span><span class="p">:</span>
                        <span class="n">a1</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
                        <span class="n">a2</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
                        <span class="n">l</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">l1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">E</span>
            <span class="n">l2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">N</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            
        <span class="c"># set matrix of normal equation</span>
        <span class="c"># N1 = a1T*a1, N2 = a2T * a2, n1 = a1T * l1, n2 = a2T * l2</span>
        <span class="n">N1</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">)]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">)]</span>
        <span class="n">N2</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">)]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">)]</span>
        <span class="n">n1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">)]</span>
        <span class="n">n2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">m</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">m</span><span class="p">):</span>
                <span class="n">s1</span> <span class="o">=</span> <span class="mf">0.0</span>
                <span class="n">s2</span> <span class="o">=</span> <span class="mf">0.0</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                    <span class="n">s1</span> <span class="o">=</span> <span class="n">s1</span> <span class="o">+</span> <span class="n">a1</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">a1</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
                    <span class="n">s2</span> <span class="o">=</span> <span class="n">s2</span> <span class="o">+</span> <span class="n">a2</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">a2</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
                <span class="n">N1</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">s1</span>
                <span class="n">N1</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">s1</span>
                <span class="n">N2</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">s2</span>
                <span class="n">N2</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">s2</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">m</span><span class="p">):</span>
            <span class="n">s1</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">s2</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="p">):</span>
                <span class="n">s1</span> <span class="o">=</span> <span class="n">s1</span> <span class="o">+</span> <span class="n">a1</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">l1</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="n">s2</span> <span class="o">=</span> <span class="n">s2</span> <span class="o">+</span> <span class="n">a2</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">l2</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">n1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">s1</span>
            <span class="n">n2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">s2</span>

        <span class="c"># solve the normal equation</span>
        <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">inv1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">gauss_elimination</span><span class="p">(</span><span class="n">N1</span><span class="p">,</span> <span class="n">n1</span><span class="p">)</span>
        <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">inv2</span><span class="p">)</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">gauss_elimination</span><span class="p">(</span><span class="n">N2</span><span class="p">,</span> <span class="n">n2</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="p">[</span><span class="n">avge</span><span class="p">,</span> <span class="n">avgn</span><span class="p">,</span> <span class="n">avgE</span><span class="p">,</span> <span class="n">avgN</span><span class="p">])</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span></div></div>
<span class="sd">        modul test</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">p2</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;2&quot;</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">distance2d</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="mf">70.7107</span><span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Distance2d test failed&quot;</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">distance3d</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="mf">71.4143</span><span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Distance3d test failed&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">bearing</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&#39;DMS&#39;</span><span class="p">),</span> <span class="s">&#39;45-00-00&#39;</span><span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Bearing p1-p2 test failed&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">bearing</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">p1</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&#39;DMS&#39;</span><span class="p">),</span> <span class="s">&#39;225-00-00&#39;</span><span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Bearing p2-p1 test failed&quot;</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">bearing</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p1</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&#39;DMS&#39;</span><span class="p">),</span> <span class="s">&#39;0-00-00&#39;</span><span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Bearing p1-p1 test failed&quot;</span>
    
    <span class="c"># intersection test</span>
    <span class="n">s1o</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="s">&#39;station&#39;</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
    <span class="n">s2o</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;2&#39;</span><span class="p">,</span> <span class="s">&#39;station&#39;</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
    <span class="n">s1</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">s1o</span><span class="p">)</span>
    <span class="n">s2</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="n">s2o</span><span class="p">)</span>
    <span class="n">o1</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;p&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="s">&quot;DEG&quot;</span><span class="p">))</span>
    <span class="n">o2</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;p&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="mi">310</span><span class="p">,</span> <span class="s">&quot;DEG&quot;</span><span class="p">))</span>
    <span class="n">p3</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">o1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">o2</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span><span class="n">p3</span><span class="p">,</span> <span class="n">Point</span><span class="p">(</span><span class="s">&#39;p&#39;</span><span class="p">,</span> <span class="mf">130.8201</span><span class="p">,</span> <span class="mf">266.0939</span><span class="p">)):</span>
        <span class="k">print</span> <span class="s">&quot;Simple-1 intersection test failed&quot;</span>
    <span class="n">A1</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;A1&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">150</span><span class="p">,</span> <span class="o">-</span><span class="mi">120</span><span class="p">)</span>
    <span class="n">A2</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;A2&quot;</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span>
    <span class="n">sA1o</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;A1&#39;</span><span class="p">,</span> <span class="s">&#39;station&#39;</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;76-13-23&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">))</span>
    <span class="n">sA2o</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;A2&#39;</span><span class="p">,</span> <span class="s">&#39;station&#39;</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;324-10-58&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">))</span>
    <span class="n">sA1</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="n">sA1o</span><span class="p">)</span>
    <span class="n">sA2</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span><span class="n">A2</span><span class="p">,</span> <span class="n">sA2o</span><span class="p">)</span>
    <span class="n">oA1</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;p3&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;308-46-36&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">))</span>
    <span class="n">oA2</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;p3&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;345-49-02&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">))</span>
    <span class="n">P3</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">sA1</span><span class="p">,</span> <span class="n">oA1</span><span class="p">,</span> <span class="n">sA2</span><span class="p">,</span> <span class="n">oA2</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span><span class="n">P3</span><span class="p">,</span> <span class="n">Point</span><span class="p">(</span><span class="s">&#39;p3&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.8979</span><span class="p">,</span> <span class="mf">189.0319</span><span class="p">)):</span>
        <span class="k">print</span> <span class="s">&quot;Simple-2 intersection test failed&quot;</span>
    <span class="n">sA1o</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;A1&#39;</span><span class="p">,</span> <span class="s">&#39;station&#39;</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;0&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">))</span>
    <span class="n">sA2o</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;A2&#39;</span><span class="p">,</span> <span class="s">&#39;station&#39;</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;0&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">))</span>
    <span class="n">sA1</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="n">sA1o</span><span class="p">)</span>
    <span class="n">sA2</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span><span class="n">A2</span><span class="p">,</span> <span class="n">sA2o</span><span class="p">)</span>
    <span class="n">oA1</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;p4&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;225&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">))</span>
    <span class="n">oA2</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;p4&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;45&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">))</span>
    <span class="n">P4</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">sA1</span><span class="p">,</span> <span class="n">oA1</span><span class="p">,</span> <span class="n">sA2</span><span class="p">,</span> <span class="n">oA2</span><span class="p">)</span>
    <span class="k">print</span> <span class="s">&quot;Result for impossible intersection:&quot;</span>
    <span class="k">print</span> <span class="n">P4</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">P4</span><span class="o">.</span><span class="n">e</span><span class="p">,</span> <span class="n">P4</span><span class="o">.</span><span class="n">n</span>
    <span class="n">A3</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;A3&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">A4</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;A4&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">sA3o</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;A3&#39;</span><span class="p">,</span> <span class="s">&#39;station&#39;</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;0&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">))</span>
    <span class="n">sA4o</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;A4&#39;</span><span class="p">,</span> <span class="s">&#39;station&#39;</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;0&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">))</span>
    <span class="n">sA3</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span><span class="n">A3</span><span class="p">,</span> <span class="n">sA3o</span><span class="p">)</span>
    <span class="n">sA4</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span><span class="n">A4</span><span class="p">,</span> <span class="n">sA4o</span><span class="p">)</span>
    <span class="n">oA3</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;p5&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;45&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">))</span>
    <span class="n">oA4</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;p5&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;225&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">))</span>
    <span class="n">P5</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">sA3</span><span class="p">,</span> <span class="n">oA3</span><span class="p">,</span> <span class="n">sA4</span><span class="p">,</span> <span class="n">oA4</span><span class="p">)</span>
    <span class="k">print</span> <span class="s">&quot;Result for observe each other:&quot;</span>
    <span class="k">print</span> <span class="n">P5</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">P5</span><span class="o">.</span><span class="n">e</span><span class="p">,</span> <span class="n">P5</span><span class="o">.</span><span class="n">n</span> <span class="c">#p5 100.0 100.0</span>
    <span class="n">A3</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;A3&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">A4</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;A4&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">sA3o</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;A3&#39;</span><span class="p">,</span> <span class="s">&#39;station&#39;</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;0&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">))</span>
    <span class="n">sA4o</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;A4&#39;</span><span class="p">,</span> <span class="s">&#39;station&#39;</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;0&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">))</span>
    <span class="n">sA3</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span><span class="n">A3</span><span class="p">,</span> <span class="n">sA3o</span><span class="p">)</span>
    <span class="n">sA4</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span><span class="n">A4</span><span class="p">,</span> <span class="n">sA4o</span><span class="p">)</span>
    <span class="n">oA3</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;p5&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;45&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">))</span>
    <span class="n">oA4</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;p5&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;45&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">))</span>
    <span class="n">P5</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">sA3</span><span class="p">,</span> <span class="n">oA3</span><span class="p">,</span> <span class="n">sA4</span><span class="p">,</span> <span class="n">oA4</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span><span class="n">P5</span><span class="p">,</span> <span class="bp">None</span><span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Intersection test for parallel observation failed&quot;</span>
    
    <span class="c"># resection test</span>
    <span class="n">p1res</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;3&quot;</span><span class="p">)</span>
    <span class="n">o1res</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;3&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">s1res</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="n">p1res</span><span class="p">,</span> <span class="n">o1res</span> <span class="p">)</span>
    <span class="n">p101res</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;101&quot;</span><span class="p">,</span> <span class="mf">658031.813</span><span class="p">,</span> <span class="mf">247985.580</span> <span class="p">)</span>
    <span class="n">p102res</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;102&quot;</span><span class="p">,</span> <span class="mf">657638.800</span><span class="p">,</span> <span class="mf">247759.380</span> <span class="p">)</span>
    <span class="n">p103res</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;103&quot;</span><span class="p">,</span> <span class="mf">658077.700</span><span class="p">,</span> <span class="mf">247431.381</span> <span class="p">)</span>
    <span class="n">o101res</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;101&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;22-45-56&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">o102res</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;102&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;164-38-59&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">o103res</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;103&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;96-23-12&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">p1res</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">resection</span><span class="p">(</span> <span class="n">s1res</span><span class="p">,</span> <span class="n">p101res</span><span class="p">,</span> <span class="n">p102res</span><span class="p">,</span> <span class="n">p103res</span><span class="p">,</span> <span class="n">o101res</span><span class="p">,</span> <span class="n">o102res</span><span class="p">,</span> <span class="n">o103res</span> <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">p1res</span><span class="p">,</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;3&quot;</span><span class="p">,</span> <span class="mf">657871.9494</span><span class="p">,</span> <span class="mf">247973.2414</span> <span class="p">)</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Simple-1 resection test failed&quot;</span>
    <span class="n">P4res</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;P4&quot;</span><span class="p">)</span>
    <span class="n">oP4res</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;P4&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">sP4res</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="n">P4res</span><span class="p">,</span> <span class="n">oP4res</span> <span class="p">)</span>
    <span class="n">o101res</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;101&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;202-45-56&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">o102res</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;102&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;344-38-59&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">o103res</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;103&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;276-23-12&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">P4res</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">resection</span><span class="p">(</span> <span class="n">sP4res</span><span class="p">,</span> <span class="n">p101res</span><span class="p">,</span> <span class="n">p102res</span><span class="p">,</span> <span class="n">p103res</span><span class="p">,</span> <span class="n">o101res</span><span class="p">,</span> <span class="n">o102res</span><span class="p">,</span> <span class="n">o103res</span> <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">P4res</span><span class="p">,</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;P4&quot;</span><span class="p">,</span> <span class="mf">657871.9494</span><span class="p">,</span> <span class="mf">247973.2414</span> <span class="p">)</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Simple-2 resection test failed&quot;</span>
    <span class="n">P5res</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;P5&quot;</span><span class="p">)</span>
    <span class="n">oP5res</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;P5&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">sP5res</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="n">P5res</span><span class="p">,</span> <span class="n">oP5res</span> <span class="p">)</span>
    <span class="n">o101res</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;101&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;88-41-35.8669&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">o102res</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;102&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;40-11-52.9394&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">o103res</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;103&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;155-23-15.1567&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">P5res</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">resection</span><span class="p">(</span> <span class="n">sP5res</span><span class="p">,</span> <span class="n">p101res</span><span class="p">,</span> <span class="n">p102res</span><span class="p">,</span> <span class="n">p103res</span><span class="p">,</span> <span class="n">o101res</span><span class="p">,</span> <span class="n">o102res</span><span class="p">,</span> <span class="n">o103res</span> <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">P5res</span><span class="p">,</span> <span class="bp">None</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Resection test for dangerous circle failed&quot;</span>
    <span class="n">P6res</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;P6&quot;</span><span class="p">)</span>
    <span class="n">oP6res</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;P6&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">sP6res</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="n">P6res</span><span class="p">,</span> <span class="n">oP6res</span> <span class="p">)</span>
    <span class="n">p101res</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;101&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">80</span> <span class="p">)</span>
    <span class="n">p102res</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;102&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">80</span> <span class="p">)</span>
    <span class="n">p103res</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;103&quot;</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">80</span> <span class="p">)</span>
    <span class="n">o101res</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;101&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;140-32-24&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">o102res</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;102&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;97-13-15&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">o103res</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;103&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;70-43-22&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">P6res</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">resection</span><span class="p">(</span> <span class="n">sP6res</span><span class="p">,</span> <span class="n">p101res</span><span class="p">,</span> <span class="n">p102res</span><span class="p">,</span> <span class="n">p103res</span><span class="p">,</span> <span class="n">o101res</span><span class="p">,</span> <span class="n">o102res</span><span class="p">,</span> <span class="n">o103res</span> <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">P6res</span><span class="p">,</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;P6&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">29.6182</span><span class="p">,</span> <span class="mf">142.6576</span> <span class="p">)</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Resection test for reference points on a line failed&quot;</span>
    <span class="n">P7res</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;P7&quot;</span><span class="p">)</span>
    <span class="n">oP7res</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;P7&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">sP7res</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="n">P7res</span><span class="p">,</span> <span class="n">oP7res</span> <span class="p">)</span>
    <span class="n">p101res</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;101&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">80</span> <span class="p">)</span>
    <span class="n">p102res</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;102&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">80</span> <span class="p">)</span>
    <span class="n">p103res</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;103&quot;</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">80</span> <span class="p">)</span>
    <span class="n">o101res</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;101&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;225&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">o102res</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;102&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;45&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">o103res</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;103&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;45&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">P7res</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">resection</span><span class="p">(</span> <span class="n">sP7res</span><span class="p">,</span> <span class="n">p101res</span><span class="p">,</span> <span class="n">p102res</span><span class="p">,</span> <span class="n">p103res</span><span class="p">,</span> <span class="n">o101res</span><span class="p">,</span> <span class="n">o102res</span><span class="p">,</span> <span class="n">o103res</span> <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">P7res</span><span class="p">,</span> <span class="bp">None</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Resection test for reference points and station point on a line failed&quot;</span>
    
    <span class="c">#orientation</span>
    <span class="n">p101ori</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;101&quot;</span><span class="p">,</span> <span class="mf">5693.45</span><span class="p">,</span> <span class="mf">328.81</span> <span class="p">)</span>
    <span class="n">p102ori</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;102&quot;</span><span class="p">,</span> <span class="mf">6002.13</span><span class="p">,</span> <span class="mf">1001.13</span> <span class="p">)</span>
    <span class="n">p103ori</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;103&quot;</span><span class="p">,</span> <span class="mf">5511.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">253.16</span> <span class="p">)</span>
    <span class="n">p104ori</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;104&quot;</span><span class="p">,</span> <span class="mf">5033.45</span><span class="p">,</span> <span class="o">-</span><span class="mf">396.15</span> <span class="p">)</span>
    <span class="n">p201ori</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;201&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">4396.15</span><span class="p">,</span> <span class="o">-</span><span class="mf">561.13</span> <span class="p">)</span>
    <span class="n">p202ori</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;202&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">4000.55</span><span class="p">,</span> <span class="mf">496.14</span> <span class="p">)</span>
    <span class="n">p203ori</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;203&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">5115.33</span><span class="p">,</span> <span class="mf">366.11</span> <span class="p">)</span>
    <span class="n">p204ori</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;204&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">3863.96</span><span class="p">,</span> <span class="o">-</span><span class="mf">268.15</span> <span class="p">)</span>
    <span class="n">p205ori</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;205&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">3455.37</span><span class="p">,</span> <span class="o">-</span><span class="mf">959.36</span> <span class="p">)</span>
    <span class="n">p206ori</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;206&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">5500.08</span><span class="p">,</span> <span class="o">-</span><span class="mf">724.69</span> <span class="p">)</span>
    <span class="n">p301ori</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;301&quot;</span><span class="p">,</span> <span class="mf">4512.35</span><span class="p">,</span> <span class="o">-</span><span class="mf">496.29</span> <span class="p">)</span>
    <span class="n">p302ori</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;302&quot;</span><span class="p">,</span> <span class="mf">4073.16</span><span class="p">,</span> <span class="o">-</span><span class="mf">986.32</span> <span class="p">)</span>
    <span class="n">p303ori</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;303&quot;</span><span class="p">,</span> <span class="mf">3952.25</span><span class="p">,</span> <span class="mf">818.66</span> <span class="p">)</span>
    <span class="n">p401ori</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;401&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">3516.22</span><span class="p">,</span> <span class="mf">156.25</span> <span class="p">)</span>
    <span class="n">p402ori</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;402&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">3986.35</span><span class="p">,</span> <span class="mf">460.18</span> <span class="p">)</span>
    <span class="n">p403ori</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;403&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">4019.28</span><span class="p">,</span> <span class="mf">510.54</span> <span class="p">)</span>
    <span class="n">p501ori</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;501&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">116.94</span><span class="p">,</span> <span class="mf">150.86</span> <span class="p">)</span>
    <span class="n">p502ori</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;502&quot;</span><span class="p">,</span> <span class="mf">127.03</span><span class="p">,</span> <span class="mf">337.43</span> <span class="p">)</span>
    <span class="n">p503ori</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;503&quot;</span><span class="p">,</span> <span class="mf">887.64</span><span class="p">,</span> <span class="o">-</span><span class="mf">1068.99</span> <span class="p">)</span>
    <span class="n">p504ori</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;504&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">999.53</span><span class="p">,</span> <span class="o">-</span><span class="mf">896.77</span> <span class="p">)</span>
    <span class="n">p505ori</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;505&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">1150.22</span><span class="p">,</span> <span class="mf">150.86</span> <span class="p">)</span>
    <span class="n">o101ori</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;101&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">)</span>
    <span class="n">s101ori</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="n">p101ori</span><span class="p">,</span> <span class="n">o101ori</span> <span class="p">)</span>
    <span class="n">o102ori</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;102&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;268-14-13&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">o103ori</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;103&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;80-57-34&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">o104ori</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;104&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;105-53-19&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">z101ori</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">orientation</span><span class="p">(</span><span class="n">s101ori</span><span class="p">,</span> <span class="p">[[</span><span class="n">p102ori</span><span class="p">,</span><span class="n">o102ori</span><span class="p">],</span> <span class="p">[</span><span class="n">p103ori</span><span class="p">,</span><span class="n">o103ori</span><span class="p">],</span> <span class="p">[</span><span class="n">p104ori</span><span class="p">,</span><span class="n">o104ori</span><span class="p">]])</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">z101ori</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&#39;DMS&#39;</span><span class="p">),</span> <span class="s">&#39;116-25-30&#39;</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Simple-1 orientation test failed&quot;</span>
    <span class="n">o201ori</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;201&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">)</span>
    <span class="n">s201ori</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="n">p201ori</span><span class="p">,</span> <span class="n">o201ori</span> <span class="p">)</span>
    <span class="n">o202ori</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;202&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;316-40-57&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">o203ori</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;203&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;258-22-09&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">o204ori</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;204&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;357-19-49&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">o205ori</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;205&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;49-6-32&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">o206ori</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;206&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;197-44-22&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">z201ori</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">orientation</span><span class="p">(</span><span class="n">s201ori</span><span class="p">,</span> <span class="p">[[</span><span class="n">p202ori</span><span class="p">,</span><span class="n">o202ori</span><span class="p">],</span> <span class="p">[</span><span class="n">p203ori</span><span class="p">,</span><span class="n">o203ori</span><span class="p">],</span> <span class="p">[</span><span class="n">p204ori</span><span class="p">,</span><span class="n">o204ori</span><span class="p">],</span> <span class="p">[</span><span class="n">p205ori</span><span class="p">,</span><span class="n">o205ori</span><span class="p">],</span> <span class="p">[</span><span class="n">p206ori</span><span class="p">,</span><span class="n">o206ori</span><span class="p">]])</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">z201ori</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&#39;DMS&#39;</span><span class="p">),</span> <span class="s">&#39;63-50-00&#39;</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Simple-2 orientation test failed&quot;</span>
    <span class="n">o201ori</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;201&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">)</span>
    <span class="n">s201ori</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="n">p201ori</span><span class="p">,</span> <span class="n">o201ori</span> <span class="p">)</span>
    <span class="n">o202ori</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;202&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="mf">351.86944</span><span class="p">,</span> <span class="s">&quot;GON&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">o203ori</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;203&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="mf">287.07685</span><span class="p">,</span> <span class="s">&quot;GON&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">o204ori</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;204&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="mf">397.03364</span><span class="p">,</span> <span class="s">&quot;GON&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">o205ori</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;205&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="mf">54.56543</span><span class="p">,</span> <span class="s">&quot;GON&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">o206ori</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;206&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="mf">219.71049</span><span class="p">,</span> <span class="s">&quot;GON&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">z201ori</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">orientation</span><span class="p">(</span><span class="n">s201ori</span><span class="p">,</span> <span class="p">[[</span><span class="n">p202ori</span><span class="p">,</span><span class="n">o202ori</span><span class="p">],</span> <span class="p">[</span><span class="n">p203ori</span><span class="p">,</span><span class="n">o203ori</span><span class="p">],</span> <span class="p">[</span><span class="n">p204ori</span><span class="p">,</span><span class="n">o204ori</span><span class="p">],</span> <span class="p">[</span><span class="n">p205ori</span><span class="p">,</span><span class="n">o205ori</span><span class="p">],</span> <span class="p">[</span><span class="n">p206ori</span><span class="p">,</span><span class="n">o206ori</span><span class="p">]])</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">z201ori</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&#39;DMS&#39;</span><span class="p">),</span> <span class="s">&#39;63-50-00&#39;</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Simple-3 orientation test failed&quot;</span>
    <span class="n">o301ori</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;301&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">)</span>
    <span class="n">s301ori</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="n">p301ori</span><span class="p">,</span> <span class="n">o301ori</span> <span class="p">)</span>
    <span class="n">o302ori</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;302&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;166-10-30&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">o303ori</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;303&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;281-13-55&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">z301ori</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">orientation</span><span class="p">(</span><span class="n">s301ori</span><span class="p">,</span> <span class="p">[[</span><span class="n">p302ori</span><span class="p">,</span><span class="n">o302ori</span><span class="p">],</span> <span class="p">[</span><span class="n">p303ori</span><span class="p">,</span><span class="n">o303ori</span><span class="p">]])</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">z301ori</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&#39;DMS&#39;</span><span class="p">),</span> <span class="s">&#39;55-41-44&#39;</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Simple-4 orientation test failed&quot;</span>
    <span class="n">o401ori</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;401&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">)</span>
    <span class="n">s401ori</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="n">p401ori</span><span class="p">,</span> <span class="n">o401ori</span> <span class="p">)</span>
    <span class="n">o402ori</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;402&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;101-37-23&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">o403ori</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;403&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;103-53-37&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">z401ori</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">orientation</span><span class="p">(</span><span class="n">s401ori</span><span class="p">,</span> <span class="p">[[</span><span class="n">p402ori</span><span class="p">,</span><span class="n">o402ori</span><span class="p">],</span> <span class="p">[</span><span class="n">p403ori</span><span class="p">,</span><span class="n">o403ori</span><span class="p">]])</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">z401ori</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&#39;DMS&#39;</span><span class="p">),</span> <span class="s">&#39;201-15-38&#39;</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Simple-5 orientation test failed&quot;</span>
    <span class="n">o401ori</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;401&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">)</span>
    <span class="n">s401ori</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="n">p401ori</span><span class="p">,</span> <span class="n">o401ori</span> <span class="p">)</span>
    <span class="n">o402ori</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;402&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;101-37-23&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">z401ori</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">orientation</span><span class="p">(</span><span class="n">s401ori</span><span class="p">,</span> <span class="p">[[</span><span class="n">p402ori</span><span class="p">,</span><span class="n">o402ori</span><span class="p">]])</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">z401ori</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&#39;DMS&#39;</span><span class="p">),</span> <span class="s">&#39;201-15-32&#39;</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Simple-6 orientation test failed&quot;</span>
    <span class="n">o501ori</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;501&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">)</span>
    <span class="n">s501ori</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="n">p501ori</span><span class="p">,</span> <span class="n">o501ori</span> <span class="p">)</span>
    <span class="n">o502ori</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;502&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;170-50-59&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">o503ori</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;503&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;258-46-56&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">o504ori</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;504&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;338-22-5&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">o505ori</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;505&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;28-15-23&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">z501ori</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">orientation</span><span class="p">(</span><span class="n">s501ori</span><span class="p">,</span> <span class="p">[[</span><span class="n">p502ori</span><span class="p">,</span><span class="n">o502ori</span><span class="p">],</span> <span class="p">[</span><span class="n">p503ori</span><span class="p">,</span><span class="n">o503ori</span><span class="p">],</span> <span class="p">[</span><span class="n">p504ori</span><span class="p">,</span><span class="n">o504ori</span><span class="p">],</span> <span class="p">[</span><span class="n">p505ori</span><span class="p">,</span><span class="n">o505ori</span><span class="p">]])</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">z501ori</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&#39;DMS&#39;</span><span class="p">),</span> <span class="s">&#39;241-44-41&#39;</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Simple-6 orientation test failed&quot;</span>

    <span class="c"># polar points</span>
    <span class="n">p101pol</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;101&quot;</span><span class="p">,</span> <span class="mf">13456.25</span><span class="p">,</span> <span class="mf">12569.75</span><span class="p">)</span>
    <span class="n">p201pol</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;201&quot;</span><span class="p">,</span> <span class="mf">13102.13</span><span class="p">,</span> <span class="mf">11990.13</span><span class="p">)</span>
    <span class="n">p202pol</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;202&quot;</span><span class="p">,</span> <span class="mf">13569.11</span><span class="p">,</span> <span class="mf">12788.66</span><span class="p">)</span>
    <span class="n">p203pol</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;203&quot;</span><span class="p">,</span> <span class="mf">13861.23</span><span class="p">,</span> <span class="mf">12001.54</span><span class="p">)</span>
    <span class="n">o101pol</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;101&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">)</span>
    <span class="n">s101pol</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="n">p101pol</span><span class="p">,</span> <span class="n">o101pol</span> <span class="p">)</span>
    <span class="n">o201pol</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;201&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;112-15-15&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">))</span>
    <span class="n">o202pol</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;202&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;288-06-30&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">))</span>
    <span class="n">o203pol</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;203&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;45-21-12&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">))</span>
    <span class="n">o9pol</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;9&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;145-10-16&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">206.17</span><span class="p">,</span><span class="s">&quot;HD&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">o10pol</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;10&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;201-30-47&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">219.38</span><span class="p">,</span><span class="s">&quot;HD&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">z101pol</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">orientation</span><span class="p">(</span><span class="n">s101pol</span><span class="p">,</span> <span class="p">[[</span><span class="n">p201pol</span><span class="p">,</span><span class="n">o201pol</span><span class="p">],</span> <span class="p">[</span><span class="n">p202pol</span><span class="p">,</span><span class="n">o202pol</span><span class="p">],</span> <span class="p">[</span><span class="n">p203pol</span><span class="p">,</span><span class="n">o203pol</span><span class="p">]])</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">z101pol</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&#39;DMS&#39;</span><span class="p">),</span> <span class="s">&#39;99-10-05&#39;</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Simple-1 polar points test failed by orientation&quot;</span>
    <span class="n">s101pol</span><span class="o">.</span><span class="n">o</span><span class="o">.</span><span class="n">hz</span> <span class="o">=</span> <span class="n">z101pol</span>
    <span class="n">p9pol</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">polarpoint</span><span class="p">(</span><span class="n">s101pol</span><span class="p">,</span> <span class="n">o9pol</span><span class="p">)</span>
    <span class="n">p10pol</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">polarpoint</span><span class="p">(</span><span class="n">s101pol</span><span class="p">,</span> <span class="n">o10pol</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">p9pol</span><span class="p">,</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;9&quot;</span><span class="p">,</span> <span class="mf">13270.4141</span><span class="p">,</span> <span class="mf">12480.4691</span> <span class="p">)</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Simple-1 polar points test failed by P9&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">p10pol</span><span class="p">,</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;10&quot;</span><span class="p">,</span> <span class="mf">13267.5785</span><span class="p">,</span> <span class="mf">12681.6903</span> <span class="p">)</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Simple-1 polar points test failed by P10&quot;</span>
    <span class="n">pA1pol</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;A1&quot;</span><span class="p">,</span> <span class="mf">153.867</span><span class="p">,</span> <span class="mf">456.430</span><span class="p">)</span>
    <span class="n">pT1pol</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;T1&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">237.865</span><span class="p">,</span> <span class="o">-</span><span class="mf">297.772</span><span class="p">)</span>
    <span class="n">pT2pol</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;T2&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">1549.927</span><span class="p">,</span> <span class="mf">669.6126</span><span class="p">)</span>
    <span class="n">pT3pol</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;T3&quot;</span><span class="p">,</span> <span class="mf">1203.064</span><span class="p">,</span> <span class="o">-</span><span class="mf">220.0314</span><span class="p">)</span>
    <span class="n">oA1pol</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;A1&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">)</span>
    <span class="n">sA1pol</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="n">pA1pol</span><span class="p">,</span> <span class="n">oA1pol</span> <span class="p">)</span>
    <span class="n">oT1pol</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;T1&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;73-02-35&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">))</span>
    <span class="n">oT2pol</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;T2&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;142-43-39&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">))</span>
    <span class="n">oT3pol</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;T3&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;348-24-26&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">))</span>
    <span class="n">oP1pol</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;P1&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;112-43-47&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">673.699</span><span class="p">,</span><span class="s">&quot;HD&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">oP2pol</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;P2&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;84-0-44&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">788.105</span><span class="p">,</span><span class="s">&quot;HD&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">zA1pol</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">orientation</span><span class="p">(</span><span class="n">sA1pol</span><span class="p">,</span> <span class="p">[[</span><span class="n">pT1pol</span><span class="p">,</span><span class="n">oT1pol</span><span class="p">],</span> <span class="p">[</span><span class="n">pT2pol</span><span class="p">,</span><span class="n">oT2pol</span><span class="p">],</span> <span class="p">[</span><span class="n">pT3pol</span><span class="p">,</span><span class="n">oT3pol</span><span class="p">]])</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">zA1pol</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&#39;DMS&#39;</span><span class="p">),</span> <span class="s">&#39;134-24-16&#39;</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Simple-2 polar points test failed by orientation&quot;</span>
    <span class="n">sA1pol</span><span class="o">.</span><span class="n">o</span><span class="o">.</span><span class="n">hz</span> <span class="o">=</span> <span class="n">zA1pol</span>
    <span class="n">pP1pol</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">polarpoint</span><span class="p">(</span><span class="n">sA1pol</span><span class="p">,</span> <span class="n">oP1pol</span><span class="p">)</span>
    <span class="n">pP2pol</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">polarpoint</span><span class="p">(</span><span class="n">sA1pol</span><span class="p">,</span> <span class="n">oP2pol</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">pP1pol</span><span class="p">,</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;P1&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">466.8905</span><span class="p">,</span> <span class="mf">194.6468</span> <span class="p">)</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Simple-2 polar points test failed by P1&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">pP2pol</span><span class="p">,</span> <span class="n">Point</span><span class="p">(</span> <span class="s">&quot;P2&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">335.8415</span><span class="p">,</span> <span class="o">-</span><span class="mf">161.0610</span> <span class="p">)</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Simple-2 polar points test failed by P2&quot;</span>
    
    <span class="c">#traverse1</span>
    <span class="c"># closed at one end and known bearings at one end (free traverse)</span>
    <span class="n">p5241otra</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;5241&quot;</span><span class="p">,</span><span class="mf">646414.44</span><span class="p">,</span><span class="mf">211712.77</span><span class="p">)</span>
    <span class="n">p5245otra</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;5245&quot;</span><span class="p">,</span><span class="mf">646938.71</span><span class="p">,</span><span class="mf">212635.92</span><span class="p">)</span>
    <span class="n">p5246otra</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;5246&quot;</span><span class="p">,</span><span class="mf">646380.61</span><span class="p">,</span><span class="mf">212793.97</span><span class="p">)</span>
    <span class="n">p5247otra</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;5247&quot;</span><span class="p">,</span><span class="mf">646381.14</span><span class="p">,</span><span class="mf">212476.49</span><span class="p">)</span>
    <span class="n">o5247otra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;5247&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">)</span>
    <span class="n">s5247otra</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="n">p5247otra</span><span class="p">,</span> <span class="n">o5247otra</span> <span class="p">)</span>
    <span class="n">o5241otra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;5241&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;245-23-41&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">o5245otra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;5245&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;141-56-11&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">o5246otra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;5246&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;67-47-14&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">s5247otra</span><span class="o">.</span><span class="n">o</span><span class="o">.</span><span class="n">hz</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">orientation</span><span class="p">(</span><span class="n">s5247otra</span><span class="p">,</span> <span class="p">[[</span><span class="n">p5241otra</span><span class="p">,</span><span class="n">o5241otra</span><span class="p">],</span> <span class="p">[</span><span class="n">p5245otra</span><span class="p">,</span><span class="n">o5245otra</span><span class="p">],</span> <span class="p">[</span><span class="n">p5246otra</span><span class="p">,</span><span class="n">o5246otra</span><span class="p">]])</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">s5247otra</span><span class="o">.</span><span class="n">o</span><span class="o">.</span><span class="n">hz</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&#39;DMS&#39;</span><span class="p">),</span> <span class="s">&#39;292-06-34&#39;</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Traverse test for free traverse failed by orientation&quot;</span>
    
    <span class="n">o5247_111otra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;111&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;241-26-57&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">123.42</span><span class="p">,</span><span class="s">&quot;HD&quot;</span><span class="p">))</span> 
    <span class="n">s111otra</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="bp">None</span><span class="p">,</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;111&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">o111_5247otra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;5247&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;225-39-00&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">))</span> 
    <span class="n">o111_112otra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;112&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;92-38-43&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">142.81</span><span class="p">,</span><span class="s">&quot;HD&quot;</span><span class="p">))</span> 
    <span class="n">s112otra</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="bp">None</span><span class="p">,</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;112&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">o112_111otra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;111&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;227-16-34&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">))</span> 
    <span class="n">o112_113otra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;113&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;69-16-28&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">253.25</span><span class="p">,</span><span class="s">&quot;HD&quot;</span><span class="p">))</span> 
    <span class="n">s113otra</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="bp">None</span><span class="p">,</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;113&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">o113_112otra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;112&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;102-56-44&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">))</span> 
    <span class="n">o113_114otra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;114&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;205-46-21&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">214.53</span><span class="p">,</span><span class="s">&quot;HD&quot;</span><span class="p">))</span> 
    <span class="n">s114otra</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="bp">None</span><span class="p">,</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;114&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">o114_113otra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;113&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;104-23-11&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">))</span> 
    <span class="n">o114_115otra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;115&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;305-54-29&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">234.23</span><span class="p">,</span><span class="s">&quot;HD&quot;</span><span class="p">))</span> 
    <span class="n">s115otra</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="bp">None</span><span class="p">,</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;115&quot;</span><span class="p">,</span> <span class="s">&#39;station&#39;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">plist</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">traverse</span><span class="p">(</span> <span class="p">[</span> <span class="p">[</span><span class="n">s5247otra</span><span class="p">,</span><span class="bp">None</span><span class="p">,</span><span class="n">o5247_111otra</span><span class="p">],</span> <span class="p">[</span><span class="n">s111otra</span><span class="p">,</span><span class="n">o111_5247otra</span><span class="p">,</span><span class="n">o111_112otra</span><span class="p">],</span>
                           <span class="p">[</span><span class="n">s112otra</span><span class="p">,</span><span class="n">o112_111otra</span><span class="p">,</span><span class="n">o112_113otra</span><span class="p">],[</span><span class="n">s113otra</span><span class="p">,</span><span class="n">o113_112otra</span><span class="p">,</span><span class="n">o113_114otra</span><span class="p">],</span>
                           <span class="p">[</span><span class="n">s114otra</span><span class="p">,</span><span class="n">o114_113otra</span><span class="p">,</span><span class="n">o114_115otra</span><span class="p">],[</span><span class="n">s115otra</span><span class="p">,</span><span class="bp">None</span><span class="p">,</span><span class="bp">None</span><span class="p">]</span> <span class="p">]</span> <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">plist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Point</span><span class="p">(</span><span class="s">&#39;111&#39;</span><span class="p">,</span> <span class="mf">646394.9860</span><span class="p">,</span> <span class="mf">212353.8491</span><span class="p">)</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Traverse test for free traverse failed by point 111&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">plist</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Point</span><span class="p">(</span><span class="s">&#39;112&#39;</span><span class="p">,</span> <span class="mf">646302.1362</span><span class="p">,</span> <span class="mf">212245.3429</span><span class="p">)</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Traverse test for free traverse failed by point 112&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">plist</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">Point</span><span class="p">(</span><span class="s">&#39;113&#39;</span><span class="p">,</span> <span class="mf">646077.3941</span><span class="p">,</span> <span class="mf">212128.60997</span><span class="p">)</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Traverse test for free traverse failed by point 113&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">plist</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">Point</span><span class="p">(</span><span class="s">&#39;114&#39;</span><span class="p">,</span> <span class="mf">646131.5459</span><span class="p">,</span> <span class="mf">211921.02697</span><span class="p">)</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Traverse test for free traverse failed by point 114&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">plist</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">Point</span><span class="p">(</span><span class="s">&#39;115&#39;</span><span class="p">,</span> <span class="mf">646103.4028</span><span class="p">,</span> <span class="mf">211688.4938</span><span class="p">)</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Traverse test for free traverse failed by point 115&quot;</span>

    <span class="c">#traverse2</span>
    <span class="c"># closed at both ends and known bearings at both ends</span>
    <span class="n">pKtra</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;K&quot;</span><span class="p">,</span><span class="mf">599767.21</span><span class="p">,</span><span class="mf">148946.70</span><span class="p">)</span>
    <span class="n">pVtra</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;V&quot;</span><span class="p">,</span><span class="mf">599733.75</span><span class="p">,</span><span class="mf">149831.76</span><span class="p">)</span>
    <span class="n">p1015tra</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;1015&quot;</span><span class="p">,</span><span class="mf">598642.17</span><span class="p">,</span><span class="mf">148436.26</span><span class="p">)</span>
    <span class="n">p1016tra</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;1016&quot;</span><span class="p">,</span><span class="mf">600136.60</span><span class="p">,</span><span class="mf">148588.85</span><span class="p">)</span>
    <span class="n">p1017tra</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;1017&quot;</span><span class="p">,</span><span class="mf">600264.30</span><span class="p">,</span><span class="mf">149325.79</span><span class="p">)</span>
    <span class="n">p1018tra</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;1018&quot;</span><span class="p">,</span><span class="mf">598258.90</span><span class="p">,</span><span class="mf">149496.78</span><span class="p">)</span>
    <span class="n">p1019tra</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;1019&quot;</span><span class="p">,</span><span class="mf">600092.33</span><span class="p">,</span><span class="mf">150676.80</span><span class="p">)</span>

    <span class="n">oKtra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;K&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">)</span>
    <span class="n">sKtra</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="n">pKtra</span><span class="p">,</span> <span class="n">oKtra</span> <span class="p">)</span>
    <span class="n">oK_1017tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;1017&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;61-28-18&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">oK_1016tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;1016&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;142-53-28&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">oK_1015tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;1015&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;254-23-32&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">oK_1tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;1&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;17-14-18&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">139.82</span><span class="p">,</span><span class="s">&quot;HD&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">sKtra</span><span class="o">.</span><span class="n">o</span><span class="o">.</span><span class="n">hz</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">orientation</span><span class="p">(</span><span class="n">sKtra</span><span class="p">,</span> <span class="p">[[</span><span class="n">p1017tra</span><span class="p">,</span><span class="n">oK_1017tra</span><span class="p">],</span> <span class="p">[</span><span class="n">p1016tra</span><span class="p">,</span><span class="n">oK_1016tra</span><span class="p">],</span> <span class="p">[</span><span class="n">p1015tra</span><span class="p">,</span><span class="n">oK_1015tra</span><span class="p">]])</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">sKtra</span><span class="o">.</span><span class="n">o</span><span class="o">.</span><span class="n">hz</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&#39;DMS&#39;</span><span class="p">),</span> <span class="s">&#39;351-12-05&#39;</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Test traverse closed at both ends and known bearings at both ends failed by orientation1&quot;</span>
    
    <span class="n">s1tra</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="bp">None</span><span class="p">,</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">o1_Ktra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;K&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;79-28-20&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">139.85</span><span class="p">,</span><span class="s">&quot;HD&quot;</span><span class="p">))</span> 
    <span class="n">o1_2tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;2&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;236-13-46&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">269.32</span><span class="p">,</span><span class="s">&quot;HD&quot;</span><span class="p">))</span> 
    <span class="n">o1_501tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;501&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;204-58-10&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">59.12</span><span class="p">,</span><span class="s">&quot;HD&quot;</span><span class="p">))</span> 
    <span class="n">s2tra</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="bp">None</span><span class="p">,</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;2&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">o2_3tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;3&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;82-18-45&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">169.40</span><span class="p">,</span><span class="s">&quot;HD&quot;</span><span class="p">))</span> 
    <span class="n">o2_1tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;217-58-34&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">269.36</span><span class="p">,</span><span class="s">&quot;HD&quot;</span><span class="p">))</span> 
    <span class="n">s3tra</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="bp">None</span><span class="p">,</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;3&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">o3_2tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;2&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;262-18-44&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">169.45</span><span class="p">,</span><span class="s">&quot;HD&quot;</span><span class="p">))</span> 
    <span class="n">o3_Vtra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;V&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;41-18-10&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">345.90</span><span class="p">,</span><span class="s">&quot;HD&quot;</span><span class="p">))</span> 
    <span class="n">o3_502tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;502&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;344-28-25&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">55.46</span><span class="p">,</span><span class="s">&quot;HD&quot;</span><span class="p">))</span> 

    <span class="n">oVtra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;V&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">)</span>
    <span class="n">sVtra</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="n">pVtra</span><span class="p">,</span> <span class="n">oVtra</span> <span class="p">)</span>
    <span class="n">oV_3tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;3&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;257-44-08&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">345.94</span><span class="p">,</span><span class="s">&quot;HD&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">oV_1018tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;1018&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;346-24-11&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">oV_1019tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;1019&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;112-12-06&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">oV_1017tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;1017&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;222-50-58&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">sVtra</span><span class="o">.</span><span class="n">o</span><span class="o">.</span><span class="n">hz</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">orientation</span><span class="p">(</span><span class="n">sVtra</span><span class="p">,</span> <span class="p">[[</span><span class="n">p1018tra</span><span class="p">,</span><span class="n">oV_1018tra</span><span class="p">],</span> <span class="p">[</span><span class="n">p1019tra</span><span class="p">,</span><span class="n">oV_1019tra</span><span class="p">],</span> <span class="p">[</span><span class="n">p1017tra</span><span class="p">,</span><span class="n">oV_1017tra</span><span class="p">]])</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">sVtra</span><span class="o">.</span><span class="n">o</span><span class="o">.</span><span class="n">hz</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&#39;DMS&#39;</span><span class="p">),</span> <span class="s">&#39;270-47-46&#39;</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Test traverse closed at both ends and known bearings at both ends failed by orientation2&quot;</span>

    <span class="n">plist</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">traverse</span><span class="p">(</span> <span class="p">[</span> <span class="p">[</span><span class="n">sKtra</span><span class="p">,</span><span class="bp">None</span><span class="p">,</span><span class="n">oK_1tra</span><span class="p">],</span> <span class="p">[</span><span class="n">s1tra</span><span class="p">,</span><span class="n">o1_Ktra</span><span class="p">,</span><span class="n">o1_2tra</span><span class="p">],</span> <span class="p">[</span><span class="n">s2tra</span><span class="p">,</span><span class="n">o2_1tra</span><span class="p">,</span><span class="n">o2_3tra</span><span class="p">],</span>
                                   <span class="p">[</span><span class="n">s3tra</span><span class="p">,</span><span class="n">o3_2tra</span><span class="p">,</span><span class="n">o3_Vtra</span><span class="p">],</span> <span class="p">[</span><span class="n">sVtra</span><span class="p">,</span><span class="n">oV_3tra</span><span class="p">,</span><span class="bp">None</span><span class="p">]</span> <span class="p">]</span> <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">plist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Point</span><span class="p">(</span><span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="mf">599787.74865</span><span class="p">,</span> <span class="mf">149085.0079</span><span class="p">)</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Test traverse closed at both ends and known bearings at both ends failed by point 1&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">plist</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Point</span><span class="p">(</span><span class="s">&#39;2&#39;</span><span class="p">,</span> <span class="mf">599718.9691</span><span class="p">,</span> <span class="mf">149345.3886</span><span class="p">)</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Test traverse closed at both ends and known bearings at both ends failed by point 2&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">plist</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">Point</span><span class="p">(</span><span class="s">&#39;3&#39;</span><span class="p">,</span> <span class="mf">599802.5094</span><span class="p">,</span> <span class="mf">149492.7786</span><span class="p">)</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Test traverse closed at both ends and known bearings at both ends failed by point 3&quot;</span>

    <span class="c">#traverse3</span>
    <span class="c"># closed at both ends and known bearing at one end</span>
    <span class="n">pA5tra</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;A5&quot;</span><span class="p">,</span><span class="mf">646333.5695</span><span class="p">,</span><span class="mf">276616.4171</span><span class="p">)</span>
    <span class="n">pA11tra</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;A11&quot;</span><span class="p">,</span><span class="mf">646502.8710</span><span class="p">,</span><span class="mf">276361.2386</span><span class="p">)</span>
    <span class="n">pA4tra</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;A4&quot;</span><span class="p">,</span><span class="mf">646284.6886</span><span class="p">,</span><span class="mf">276659.2165</span><span class="p">)</span>

    <span class="n">oA5tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;A5&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">)</span>
    <span class="n">sA5tra</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="n">pA5tra</span><span class="p">,</span> <span class="n">oA5tra</span> <span class="p">)</span>
    <span class="n">oA5_A4tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;A4&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;311-12-21&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">oA5_A6tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;A6&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;136-36-49&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;100-13-22&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">58.405</span><span class="p">,</span><span class="s">&quot;SD&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">sA5tra</span><span class="o">.</span><span class="n">o</span><span class="o">.</span><span class="n">hz</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">orientation</span><span class="p">(</span><span class="n">sA5tra</span><span class="p">,</span> <span class="p">[[</span><span class="n">pA4tra</span><span class="p">,</span><span class="n">oA5_A4tra</span><span class="p">]])</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">sA5tra</span><span class="o">.</span><span class="n">o</span><span class="o">.</span><span class="n">hz</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&#39;DMS&#39;</span><span class="p">),</span> <span class="s">&#39;359-59-57&#39;</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Test traverse closed at both ends and known bearing at one end failed by orientation&quot;</span>
    
    <span class="n">sA6tra</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="bp">None</span><span class="p">,</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;A6&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">oA6_A5tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;A5&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;316-36-49&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;79-56-53&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">58.378</span><span class="p">,</span><span class="s">&quot;SD&quot;</span><span class="p">))</span>
    <span class="n">oA6_A7tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;A7&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;136-43-52&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;101-55-08&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">43.917</span><span class="p">,</span><span class="s">&quot;SD&quot;</span><span class="p">))</span>
    <span class="n">sA7tra</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="bp">None</span><span class="p">,</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;A7&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">oA7_A6tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;A6&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;316-43-52&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;78-21-53&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">43.878</span><span class="p">,</span><span class="s">&quot;SD&quot;</span><span class="p">))</span>
    <span class="n">oA7_A8tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;A8&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;141-48-30&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;102-29-18&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">48.459</span><span class="p">,</span><span class="s">&quot;SD&quot;</span><span class="p">))</span>
    <span class="n">sA8tra</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="bp">None</span><span class="p">,</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;A8&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">oA8_A7tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;A7&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;321-48-30&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;77-49-44&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">48.401</span><span class="p">,</span><span class="s">&quot;SD&quot;</span><span class="p">))</span>
    <span class="n">oA8_A9tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;A9&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;153-25-18&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;100-01-16&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">47.098</span><span class="p">,</span><span class="s">&quot;SD&quot;</span><span class="p">))</span>
    <span class="n">sA9tra</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="bp">None</span><span class="p">,</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;A9&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">oA9_A8tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;A8&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;333-25-18&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;80-17-11&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">47.040</span><span class="p">,</span><span class="s">&quot;SD&quot;</span><span class="p">))</span>
    <span class="n">oA9_A10tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;A10&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;153-59-32&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;97-46-19&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">58.077</span><span class="p">,</span><span class="s">&quot;SD&quot;</span><span class="p">))</span>
    <span class="n">sA10tra</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="bp">None</span><span class="p">,</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;A10&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">oA10_A9tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;A9&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;333-59-32&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;82-27-53&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">58.045</span><span class="p">,</span><span class="s">&quot;SD&quot;</span><span class="p">))</span>
    <span class="n">oA10_A11tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;A11&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;154-05-41&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;97-06-32&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">58.188</span><span class="p">,</span><span class="s">&quot;SD&quot;</span><span class="p">))</span>
    
    <span class="n">sA11tra</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="n">pA11tra</span><span class="p">,</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;A11&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">oA11_A10tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;A10&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;334-05-41&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;83-09-29&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">58.151</span><span class="p">,</span><span class="s">&quot;SD&quot;</span><span class="p">))</span>

    <span class="n">plist</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">traverse</span><span class="p">(</span> <span class="p">[</span> <span class="p">[</span><span class="n">sA5tra</span><span class="p">,</span><span class="bp">None</span><span class="p">,</span><span class="n">oA5_A6tra</span><span class="p">],</span> <span class="p">[</span><span class="n">sA6tra</span><span class="p">,</span><span class="n">oA6_A5tra</span><span class="p">,</span><span class="n">oA6_A7tra</span><span class="p">],</span> <span class="p">[</span><span class="n">sA7tra</span><span class="p">,</span><span class="n">oA7_A6tra</span><span class="p">,</span><span class="n">oA7_A8tra</span><span class="p">],</span>
             <span class="p">[</span><span class="n">sA8tra</span><span class="p">,</span><span class="n">oA8_A7tra</span><span class="p">,</span><span class="n">oA8_A9tra</span><span class="p">],</span> <span class="p">[</span><span class="n">sA9tra</span><span class="p">,</span><span class="n">oA9_A8tra</span><span class="p">,</span><span class="n">oA9_A10tra</span><span class="p">],</span> <span class="p">[</span><span class="n">sA10tra</span><span class="p">,</span><span class="n">oA10_A9tra</span><span class="p">,</span><span class="n">oA10_A11tra</span><span class="p">],</span> <span class="p">[</span><span class="n">sA11tra</span><span class="p">,</span><span class="n">oA11_A10tra</span><span class="p">,</span><span class="bp">None</span><span class="p">]</span> <span class="p">]</span> <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">plist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Point</span><span class="p">(</span><span class="s">&#39;A6&#39;</span><span class="p">,</span> <span class="mf">646373.0353</span><span class="p">,</span> <span class="mf">276574.6808</span><span class="p">)</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Test traverse closed at both ends and known bearing at one end failed by point A6&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">plist</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Point</span><span class="p">(</span><span class="s">&#39;A7&#39;</span><span class="p">,</span> <span class="mf">646402.4768</span><span class="p">,</span> <span class="mf">276543.4174</span><span class="p">)</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Test traverse closed at both ends and known bearing at one end failed by point A7&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">plist</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">Point</span><span class="p">(</span><span class="s">&#39;A8&#39;</span><span class="p">,</span> <span class="mf">646431.7153</span><span class="p">,</span> <span class="mf">276506.2621</span><span class="p">)</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Test traverse closed at both ends and known bearing at one end failed by point A8&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">plist</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">Point</span><span class="p">(</span><span class="s">&#39;A9&#39;</span><span class="p">,</span> <span class="mf">646452.4490</span><span class="p">,</span> <span class="mf">276464.8193</span><span class="p">)</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Test traverse closed at both ends and known bearing at one end failed by point A9&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">plist</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">Point</span><span class="p">(</span><span class="s">&#39;A10&#39;</span><span class="p">,</span> <span class="mf">646477.6637</span><span class="p">,</span> <span class="mf">276413.1392</span><span class="p">)</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Test traverse closed at both ends and known bearing at one end failed by point A10&quot;</span>

    <span class="c">#traverse4</span>
    <span class="c"># loop traverse</span>
    <span class="n">pA5tra</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;A5&quot;</span><span class="p">,</span><span class="mf">646333.5695</span><span class="p">,</span><span class="mf">276616.4171</span><span class="p">)</span>
    <span class="n">pA4tra</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;A4&quot;</span><span class="p">,</span><span class="mf">646284.6886</span><span class="p">,</span><span class="mf">276659.2165</span><span class="p">)</span>

    <span class="n">oA5tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;A5&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">)</span>
    <span class="n">sA5tra</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="n">pA5tra</span><span class="p">,</span> <span class="n">oA5tra</span> <span class="p">)</span>
    <span class="n">oA5_A4tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;A4&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;311-12-21&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">oA5_A6tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;A6&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;136-36-49&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;100-13-22&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">58.405</span><span class="p">,</span><span class="s">&quot;SD&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">oA5_A11tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span> <span class="s">&quot;A11&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;146-26-58&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;90-00-00&quot;</span><span class="p">,</span> <span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">306.234</span><span class="p">,</span><span class="s">&quot;SD&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">sA5tra</span><span class="o">.</span><span class="n">o</span><span class="o">.</span><span class="n">hz</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">orientation</span><span class="p">(</span><span class="n">sA5tra</span><span class="p">,</span> <span class="p">[[</span><span class="n">pA4tra</span><span class="p">,</span><span class="n">oA5_A4tra</span><span class="p">]])</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">sA5tra</span><span class="o">.</span><span class="n">o</span><span class="o">.</span><span class="n">hz</span><span class="o">.</span><span class="n">get_angle</span><span class="p">(</span><span class="s">&#39;DMS&#39;</span><span class="p">),</span> <span class="s">&#39;359-59-57&#39;</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Test traverse closed at both ends and known bearing at one end failed by orientation&quot;</span>
    
    <span class="n">sA6tra</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="bp">None</span><span class="p">,</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;A6&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">oA6_A5tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;A5&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;316-36-49&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;79-56-53&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">58.378</span><span class="p">,</span><span class="s">&quot;SD&quot;</span><span class="p">))</span>
    <span class="n">oA6_A7tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;A7&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;136-43-52&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;101-55-08&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">43.917</span><span class="p">,</span><span class="s">&quot;SD&quot;</span><span class="p">))</span>
    <span class="n">sA7tra</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="bp">None</span><span class="p">,</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;A7&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">oA7_A6tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;A6&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;316-43-52&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;78-21-53&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">43.878</span><span class="p">,</span><span class="s">&quot;SD&quot;</span><span class="p">))</span>
    <span class="n">oA7_A8tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;A8&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;141-48-30&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;102-29-18&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">48.459</span><span class="p">,</span><span class="s">&quot;SD&quot;</span><span class="p">))</span>
    <span class="n">sA8tra</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="bp">None</span><span class="p">,</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;A8&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">oA8_A7tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;A7&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;321-48-30&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;77-49-44&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">48.401</span><span class="p">,</span><span class="s">&quot;SD&quot;</span><span class="p">))</span>
    <span class="n">oA8_A9tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;A9&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;153-25-18&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;100-01-16&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">47.098</span><span class="p">,</span><span class="s">&quot;SD&quot;</span><span class="p">))</span>
    <span class="n">sA9tra</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="bp">None</span><span class="p">,</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;A9&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">oA9_A8tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;A8&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;333-25-18&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;80-17-11&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">47.040</span><span class="p">,</span><span class="s">&quot;SD&quot;</span><span class="p">))</span>
    <span class="n">oA9_A10tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;A10&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;153-59-32&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;97-46-19&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">58.077</span><span class="p">,</span><span class="s">&quot;SD&quot;</span><span class="p">))</span>
    <span class="n">sA10tra</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="bp">None</span><span class="p">,</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;A10&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">oA10_A9tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;A9&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;333-59-32&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;82-27-53&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">58.045</span><span class="p">,</span><span class="s">&quot;SD&quot;</span><span class="p">))</span>
    <span class="n">oA10_A11tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;A11&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;154-05-41&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;97-06-32&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">58.188</span><span class="p">,</span><span class="s">&quot;SD&quot;</span><span class="p">))</span>
    <span class="n">sA11tra</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span> <span class="bp">None</span><span class="p">,</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&#39;A11&#39;</span><span class="p">,</span> <span class="s">&quot;station&quot;</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">oA11_A10tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;A10&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;334-05-41&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;83-09-29&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">58.151</span><span class="p">,</span><span class="s">&quot;SD&quot;</span><span class="p">))</span>
    <span class="n">oA11_A5tra</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;A5&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;326-26-13&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;90-00-00&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Distance</span><span class="p">(</span><span class="mf">306.233</span><span class="p">,</span><span class="s">&quot;SD&quot;</span><span class="p">))</span>

    <span class="n">plist</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">traverse</span><span class="p">(</span> <span class="p">[</span> <span class="p">[</span><span class="n">sA5tra</span><span class="p">,</span><span class="bp">None</span><span class="p">,</span><span class="n">oA5_A6tra</span><span class="p">],</span> <span class="p">[</span><span class="n">sA6tra</span><span class="p">,</span><span class="n">oA6_A5tra</span><span class="p">,</span><span class="n">oA6_A7tra</span><span class="p">],</span> <span class="p">[</span><span class="n">sA7tra</span><span class="p">,</span><span class="n">oA7_A6tra</span><span class="p">,</span><span class="n">oA7_A8tra</span><span class="p">],</span>
             <span class="p">[</span><span class="n">sA8tra</span><span class="p">,</span><span class="n">oA8_A7tra</span><span class="p">,</span><span class="n">oA8_A9tra</span><span class="p">],</span> <span class="p">[</span><span class="n">sA9tra</span><span class="p">,</span><span class="n">oA9_A8tra</span><span class="p">,</span><span class="n">oA9_A10tra</span><span class="p">],</span> <span class="p">[</span><span class="n">sA10tra</span><span class="p">,</span><span class="n">oA10_A9tra</span><span class="p">,</span><span class="n">oA10_A11tra</span><span class="p">],</span> <span class="p">[</span><span class="n">sA11tra</span><span class="p">,</span><span class="n">oA11_A10tra</span><span class="p">,</span><span class="bp">None</span><span class="p">]</span> <span class="p">]</span> <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">plist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Point</span><span class="p">(</span><span class="s">&#39;A6&#39;</span><span class="p">,</span> <span class="mf">646373.0539</span><span class="p">,</span> <span class="mf">276574.6449</span><span class="p">)</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Test traverse closed at both ends and known bearing at one end failed by point A6&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">plist</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Point</span><span class="p">(</span><span class="s">&#39;A7&#39;</span><span class="p">,</span> <span class="mf">646402.5093</span><span class="p">,</span> <span class="mf">276543.3546</span><span class="p">)</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Test traverse closed at both ends and known bearing at one end failed by point A7&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">plist</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">Point</span><span class="p">(</span><span class="s">&#39;A8&#39;</span><span class="p">,</span> <span class="mf">646431.7631</span><span class="p">,</span> <span class="mf">276506.1698</span><span class="p">)</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Test traverse closed at both ends and known bearing at one end failed by point A8&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">plist</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">Point</span><span class="p">(</span><span class="s">&#39;A9&#39;</span><span class="p">,</span> <span class="mf">646452.5118</span><span class="p">,</span> <span class="mf">276464.6981</span><span class="p">)</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Test traverse closed at both ends and known bearing at one end failed by point A9&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">plist</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">Point</span><span class="p">(</span><span class="s">&#39;A10&#39;</span><span class="p">,</span> <span class="mf">646477.7451</span><span class="p">,</span> <span class="mf">276412.9820</span><span class="p">)</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Test traverse closed at both ends and known bearing at one end failed by point A10&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">plist</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">Point</span><span class="p">(</span><span class="s">&#39;A11&#39;</span><span class="p">,</span> <span class="mf">646502.9712</span><span class="p">,</span> <span class="mf">276361.0454</span><span class="p">)</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Test traverse closed at both ends and known bearing at one end failed by point A11&quot;</span>

    <span class="c"># test for polarpoint 3d</span>
    <span class="n">ppp</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span>
    <span class="n">ooo</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="s">&quot;station&quot;</span><span class="p">,</span><span class="n">Angle</span><span class="p">(</span><span class="s">&quot;0&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span><span class="bp">None</span><span class="p">,</span><span class="bp">None</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="n">sss</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span><span class="n">ppp</span><span class="p">,</span><span class="n">ooo</span><span class="p">)</span>
    <span class="n">oo2</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;2&quot;</span><span class="p">,</span><span class="bp">None</span><span class="p">,</span><span class="n">Angle</span><span class="p">(</span><span class="s">&quot;90&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;45&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Distance</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="s">&quot;SD&quot;</span><span class="p">),</span> <span class="mf">3.5</span><span class="p">)</span>
    <span class="n">pp2</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">polarpoint</span><span class="p">(</span><span class="n">sss</span><span class="p">,</span><span class="n">oo2</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">pp2</span><span class="p">,</span> <span class="n">Point</span><span class="p">(</span><span class="s">&#39;2&#39;</span><span class="p">,</span> <span class="mf">24.1421</span><span class="p">,</span> <span class="mf">20.00000</span><span class="p">,</span> <span class="mf">41.6421</span><span class="p">)</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Simple-1 polarpoint 3D test failed&quot;</span>

    <span class="n">ppp</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span>
    <span class="n">ooo</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="s">&quot;station&quot;</span><span class="p">,</span><span class="n">Angle</span><span class="p">(</span><span class="s">&quot;0&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span><span class="bp">None</span><span class="p">,</span><span class="bp">None</span><span class="p">,</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="n">sss</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span><span class="n">ppp</span><span class="p">,</span><span class="n">ooo</span><span class="p">)</span>
    <span class="n">oo2</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;2&quot;</span><span class="p">,</span><span class="bp">None</span><span class="p">,</span><span class="n">Angle</span><span class="p">(</span><span class="s">&quot;90&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;45&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Distance</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="s">&quot;SD&quot;</span><span class="p">),</span> <span class="mf">3.5</span><span class="p">)</span>
    <span class="n">pp2</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">polarpoint</span><span class="p">(</span><span class="n">sss</span><span class="p">,</span><span class="n">oo2</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">pp2</span><span class="p">,</span> <span class="n">Point</span><span class="p">(</span><span class="s">&#39;2&#39;</span><span class="p">,</span> <span class="mf">24.1421</span><span class="p">,</span> <span class="mf">20.00000</span><span class="p">,</span> <span class="mf">39.6421</span><span class="p">)</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Simple-2 polarpoint 3D test failed&quot;</span>

    <span class="n">ppp</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span>
    <span class="n">ooo</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="s">&quot;station&quot;</span><span class="p">,</span><span class="n">Angle</span><span class="p">(</span><span class="s">&quot;0&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span><span class="bp">None</span><span class="p">,</span><span class="bp">None</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="n">sss</span> <span class="o">=</span> <span class="n">Station</span><span class="p">(</span><span class="n">ppp</span><span class="p">,</span><span class="n">ooo</span><span class="p">)</span>
    <span class="n">oo2</span> <span class="o">=</span> <span class="n">PolarObservation</span><span class="p">(</span><span class="s">&quot;2&quot;</span><span class="p">,</span><span class="bp">None</span><span class="p">,</span><span class="n">Angle</span><span class="p">(</span><span class="s">&quot;90&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Angle</span><span class="p">(</span><span class="s">&quot;90&quot;</span><span class="p">,</span><span class="s">&quot;DMS&quot;</span><span class="p">),</span> <span class="n">Distance</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="s">&quot;SD&quot;</span><span class="p">),</span> <span class="mf">3.5</span><span class="p">)</span>
    <span class="n">pp2</span> <span class="o">=</span> <span class="n">Calculation</span><span class="o">.</span><span class="n">polarpoint</span><span class="p">(</span><span class="n">sss</span><span class="p">,</span><span class="n">oo2</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">compare</span><span class="p">(</span> <span class="n">pp2</span><span class="p">,</span> <span class="n">Point</span><span class="p">(</span><span class="s">&#39;2&#39;</span><span class="p">,</span> <span class="mf">30.0000</span><span class="p">,</span> <span class="mf">20.0000</span><span class="p">,</span> <span class="mf">27.5</span><span class="p">)</span> <span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;Simple-3 polarpoint 3D test failed&quot;</span>
    
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">Surveying Calculation v0.0.1b1 documentation</a> &raquo;</li>
          <li><a href="../index.html" >Module code</a> &raquo;</li>
          <li><a href="../SurveyingCalculation.html" >SurveyingCalculation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, DigiKom Ltd.
      Last updated on Jun 02, 2015.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.8.
    </div>
  </body>
</html>